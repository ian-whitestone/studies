{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "%load_ext autoreload\n",
    "%autoreload 2\n",
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "import general_utils as Ugen\n",
    "import matplotlib.pyplot as plt\n",
    "import pandas as pd\n",
    "import math\n",
    "from pandas.tools.plotting import scatter_matrix\n",
    "import numpy as np\n",
    "import glob, os\n",
    "import requests"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Load Data from CSVs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "collapsed": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Skipping line 170864: expected 11 fields, saw 12\n",
      "\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "successfully loaded: /Users/cmt606/Documents/Ian/ME/toronto-parking-tickets/data/src/Parking_Tags_data_2009.csv\n",
      "(2582382, 11)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tag_number_masked</th>\n",
       "      <th>date_of_infraction</th>\n",
       "      <th>infraction_code</th>\n",
       "      <th>infraction_description</th>\n",
       "      <th>set_fine_amount</th>\n",
       "      <th>time_of_infraction</th>\n",
       "      <th>location1</th>\n",
       "      <th>location2</th>\n",
       "      <th>location3</th>\n",
       "      <th>location4</th>\n",
       "      <th>province</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>***25289</td>\n",
       "      <td>20090101</td>\n",
       "      <td>4</td>\n",
       "      <td>PARK/LEAVE ON MUNICIPAL PRPTY</td>\n",
       "      <td>30</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>210 PRINCES BLVD</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ON</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>***70707</td>\n",
       "      <td>20090101</td>\n",
       "      <td>337</td>\n",
       "      <td>PARK - ON BOULEVARD</td>\n",
       "      <td>50</td>\n",
       "      <td>5.0</td>\n",
       "      <td>OPP</td>\n",
       "      <td>2 MARKET ST</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ON</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>***70814</td>\n",
       "      <td>20090101</td>\n",
       "      <td>9</td>\n",
       "      <td>STOP HWY PROHIBITED TIME/DAY</td>\n",
       "      <td>60</td>\n",
       "      <td>5.0</td>\n",
       "      <td>NR</td>\n",
       "      <td>140 YORKVILLE AVE</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ON</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>***70815</td>\n",
       "      <td>20090101</td>\n",
       "      <td>9</td>\n",
       "      <td>STOP HWY PROHIBITED TIME/DAY</td>\n",
       "      <td>60</td>\n",
       "      <td>5.0</td>\n",
       "      <td>NR</td>\n",
       "      <td>140 YORKVILLE AVE</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ON</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>***31104</td>\n",
       "      <td>20090101</td>\n",
       "      <td>337</td>\n",
       "      <td>PARK - ON BOULEVARD</td>\n",
       "      <td>50</td>\n",
       "      <td>5.0</td>\n",
       "      <td>OPP</td>\n",
       "      <td>2 MARKET ST</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ON</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  tag_number_masked  date_of_infraction  infraction_code  \\\n",
       "0          ***25289            20090101                4   \n",
       "1          ***70707            20090101              337   \n",
       "2          ***70814            20090101                9   \n",
       "3          ***70815            20090101                9   \n",
       "4          ***31104            20090101              337   \n",
       "\n",
       "          infraction_description  set_fine_amount  time_of_infraction  \\\n",
       "0  PARK/LEAVE ON MUNICIPAL PRPTY               30                 1.0   \n",
       "1            PARK - ON BOULEVARD               50                 5.0   \n",
       "2   STOP HWY PROHIBITED TIME/DAY               60                 5.0   \n",
       "3   STOP HWY PROHIBITED TIME/DAY               60                 5.0   \n",
       "4            PARK - ON BOULEVARD               50                 5.0   \n",
       "\n",
       "  location1          location2 location3 location4 province  \n",
       "0       NaN   210 PRINCES BLVD       NaN       NaN       ON  \n",
       "1       OPP        2 MARKET ST       NaN       NaN       ON  \n",
       "2        NR  140 YORKVILLE AVE       NaN       NaN       ON  \n",
       "3        NR  140 YORKVILLE AVE       NaN       NaN       ON  \n",
       "4       OPP        2 MARKET ST       NaN       NaN       ON  "
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "##GET DATA\n",
    "#GET FILES\n",
    "main_dir=os.getcwd()\n",
    "allFiles = glob.glob(main_dir+'/src'+ \"/*.csv\")\n",
    "\n",
    "#LOAD TO DATAFRAME\n",
    "list_ = []\n",
    "for file_path in allFiles:\n",
    "    try:\n",
    "        df = pd.read_csv(file_path,index_col=None,quoting=2,error_bad_lines=False) #quoting=2\n",
    "        list_.append(df)\n",
    "        print ('successfully loaded: '+ file_path)\n",
    "    except Exception as err:\n",
    "        if 'EOF following escape character' in str(err):\n",
    "            try:\n",
    "                df = pd.read_csv(file_path,index_col=None,encoding='utf-16',error_bad_lines=False) #quoting=2\n",
    "                list_.append(df)\n",
    "                print ('successfully loaded: '+ file_path)\n",
    "            except Exception as err:\n",
    "                print ('NOT loaded: '+ file_path)\n",
    "                print (str(err))\n",
    "        else:\n",
    "            print ('NOT loaded: '+ file_path)\n",
    "            print (str(err))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Data Cleaning and EDA"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(2582382, 11)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tag_number_masked</th>\n",
       "      <th>date_of_infraction</th>\n",
       "      <th>infraction_code</th>\n",
       "      <th>infraction_description</th>\n",
       "      <th>set_fine_amount</th>\n",
       "      <th>time_of_infraction</th>\n",
       "      <th>location1</th>\n",
       "      <th>location2</th>\n",
       "      <th>location3</th>\n",
       "      <th>location4</th>\n",
       "      <th>province</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>***25289</td>\n",
       "      <td>20090101</td>\n",
       "      <td>4</td>\n",
       "      <td>PARK/LEAVE ON MUNICIPAL PRPTY</td>\n",
       "      <td>30</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>210 PRINCES BLVD</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ON</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>***70707</td>\n",
       "      <td>20090101</td>\n",
       "      <td>337</td>\n",
       "      <td>PARK - ON BOULEVARD</td>\n",
       "      <td>50</td>\n",
       "      <td>5.0</td>\n",
       "      <td>OPP</td>\n",
       "      <td>2 MARKET ST</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ON</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>***70814</td>\n",
       "      <td>20090101</td>\n",
       "      <td>9</td>\n",
       "      <td>STOP HWY PROHIBITED TIME/DAY</td>\n",
       "      <td>60</td>\n",
       "      <td>5.0</td>\n",
       "      <td>NR</td>\n",
       "      <td>140 YORKVILLE AVE</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ON</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>***70815</td>\n",
       "      <td>20090101</td>\n",
       "      <td>9</td>\n",
       "      <td>STOP HWY PROHIBITED TIME/DAY</td>\n",
       "      <td>60</td>\n",
       "      <td>5.0</td>\n",
       "      <td>NR</td>\n",
       "      <td>140 YORKVILLE AVE</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ON</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>***31104</td>\n",
       "      <td>20090101</td>\n",
       "      <td>337</td>\n",
       "      <td>PARK - ON BOULEVARD</td>\n",
       "      <td>50</td>\n",
       "      <td>5.0</td>\n",
       "      <td>OPP</td>\n",
       "      <td>2 MARKET ST</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ON</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  tag_number_masked  date_of_infraction  infraction_code  \\\n",
       "0          ***25289            20090101                4   \n",
       "1          ***70707            20090101              337   \n",
       "2          ***70814            20090101                9   \n",
       "3          ***70815            20090101                9   \n",
       "4          ***31104            20090101              337   \n",
       "\n",
       "          infraction_description  set_fine_amount  time_of_infraction  \\\n",
       "0  PARK/LEAVE ON MUNICIPAL PRPTY               30                 1.0   \n",
       "1            PARK - ON BOULEVARD               50                 5.0   \n",
       "2   STOP HWY PROHIBITED TIME/DAY               60                 5.0   \n",
       "3   STOP HWY PROHIBITED TIME/DAY               60                 5.0   \n",
       "4            PARK - ON BOULEVARD               50                 5.0   \n",
       "\n",
       "  location1          location2 location3 location4 province  \n",
       "0       NaN   210 PRINCES BLVD       NaN       NaN       ON  \n",
       "1       OPP        2 MARKET ST       NaN       NaN       ON  \n",
       "2        NR  140 YORKVILLE AVE       NaN       NaN       ON  \n",
       "3        NR  140 YORKVILLE AVE       NaN       NaN       ON  \n",
       "4       OPP        2 MARKET ST       NaN       NaN       ON  "
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tpt_df = pd.concat(list_)\n",
    "print (tpt_df.shape)\n",
    "tpt_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "collapsed": true
   },
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "labels ['tag_number_masked' 'location3' 'location4' 'province'] not contained in axis",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-8-7d33a9909a1f>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      3\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m \u001b[0;31m# get rid of the unnecessary columns\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 5\u001b[0;31m \u001b[0mtpt_df\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mtpt_df\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdrop\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'tag_number_masked'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m'location3'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m'location4'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m'province'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0maxis\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[0;32m/Users/cmt606/anaconda2/lib/python2.7/site-packages/pandas/core/generic.pyc\u001b[0m in \u001b[0;36mdrop\u001b[0;34m(self, labels, axis, level, inplace, errors)\u001b[0m\n\u001b[1;32m   1875\u001b[0m                 \u001b[0mnew_axis\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0maxis\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdrop\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mlabels\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlevel\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mlevel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0merrors\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0merrors\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1876\u001b[0m             \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1877\u001b[0;31m                 \u001b[0mnew_axis\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0maxis\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdrop\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mlabels\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0merrors\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0merrors\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1878\u001b[0m             \u001b[0mdropped\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mreindex\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m**\u001b[0m\u001b[0;34m{\u001b[0m\u001b[0maxis_name\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mnew_axis\u001b[0m\u001b[0;34m}\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1879\u001b[0m             \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m/Users/cmt606/anaconda2/lib/python2.7/site-packages/pandas/indexes/base.pyc\u001b[0m in \u001b[0;36mdrop\u001b[0;34m(self, labels, errors)\u001b[0m\n\u001b[1;32m   3049\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0merrors\u001b[0m \u001b[0;34m!=\u001b[0m \u001b[0;34m'ignore'\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   3050\u001b[0m                 raise ValueError('labels %s not contained in axis' %\n\u001b[0;32m-> 3051\u001b[0;31m                                  labels[mask])\n\u001b[0m\u001b[1;32m   3052\u001b[0m             \u001b[0mindexer\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mindexer\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m~\u001b[0m\u001b[0mmask\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   3053\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdelete\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mindexer\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mValueError\u001b[0m: labels ['tag_number_masked' 'location3' 'location4' 'province'] not contained in axis"
     ]
    }
   ],
   "source": [
    "# drop records missing an anddress\n",
    "tpt_df=tpt_df[pd.notnull(tpt_df['location2'])]\n",
    "\n",
    "# get rid of the unnecessary columns\n",
    "tpt_df=tpt_df.drop(['tag_number_masked','location3','location4','province'],axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "There are 228533 unique locations in the dataset \n"
     ]
    }
   ],
   "source": [
    "locations = tpt_df['location2'].unique()\n",
    "print 'There are %s unique locations in the dataset ' % len(locations)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "91"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(locations)/2500 ##number of days it will take to get the data with free google api (2500 req/day)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "So obviously we can't get lat/lon for all locations...let's do it for the top X grossing spots..."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date_of_infraction</th>\n",
       "      <th>infraction_code</th>\n",
       "      <th>infraction_description</th>\n",
       "      <th>set_fine_amount</th>\n",
       "      <th>time_of_infraction</th>\n",
       "      <th>location1</th>\n",
       "      <th>location2</th>\n",
       "      <th>year</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>20090101</td>\n",
       "      <td>4</td>\n",
       "      <td>PARK/LEAVE ON MUNICIPAL PRPTY</td>\n",
       "      <td>30</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>210 PRINCES BLVD</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>20090101</td>\n",
       "      <td>337</td>\n",
       "      <td>PARK - ON BOULEVARD</td>\n",
       "      <td>50</td>\n",
       "      <td>5.0</td>\n",
       "      <td>OPP</td>\n",
       "      <td>2 MARKET ST</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>20090101</td>\n",
       "      <td>9</td>\n",
       "      <td>STOP HWY PROHIBITED TIME/DAY</td>\n",
       "      <td>60</td>\n",
       "      <td>5.0</td>\n",
       "      <td>NR</td>\n",
       "      <td>140 YORKVILLE AVE</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>20090101</td>\n",
       "      <td>9</td>\n",
       "      <td>STOP HWY PROHIBITED TIME/DAY</td>\n",
       "      <td>60</td>\n",
       "      <td>5.0</td>\n",
       "      <td>NR</td>\n",
       "      <td>140 YORKVILLE AVE</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>20090101</td>\n",
       "      <td>337</td>\n",
       "      <td>PARK - ON BOULEVARD</td>\n",
       "      <td>50</td>\n",
       "      <td>5.0</td>\n",
       "      <td>OPP</td>\n",
       "      <td>2 MARKET ST</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   date_of_infraction  infraction_code         infraction_description  \\\n",
       "0            20090101                4  PARK/LEAVE ON MUNICIPAL PRPTY   \n",
       "1            20090101              337            PARK - ON BOULEVARD   \n",
       "2            20090101                9   STOP HWY PROHIBITED TIME/DAY   \n",
       "3            20090101                9   STOP HWY PROHIBITED TIME/DAY   \n",
       "4            20090101              337            PARK - ON BOULEVARD   \n",
       "\n",
       "   set_fine_amount  time_of_infraction location1          location2  year  \n",
       "0               30                 1.0       NaN   210 PRINCES BLVD  2009  \n",
       "1               50                 5.0       OPP        2 MARKET ST  2009  \n",
       "2               60                 5.0        NR  140 YORKVILLE AVE  2009  \n",
       "3               60                 5.0        NR  140 YORKVILLE AVE  2009  \n",
       "4               50                 5.0       OPP        2 MARKET ST  2009  "
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tpt_df['year']=tpt_df['date_of_infraction'].map(lambda x: int(str(x)[0:4])) #\n",
    "tpt_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "infraction_ids = list(tpt_df.infraction_code.unique())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "tpt_grouped_df=pd.DataFrame({'count' : tpt_df.groupby( ['year','infraction_code','location2'] ).size()}).reset_index()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(367838, 4)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>year</th>\n",
       "      <th>infraction_code</th>\n",
       "      <th>location2</th>\n",
       "      <th>count</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2009</td>\n",
       "      <td>1</td>\n",
       "      <td>1 ALBERTUS AVE</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2009</td>\n",
       "      <td>1</td>\n",
       "      <td>1 BANGOR RD</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2009</td>\n",
       "      <td>1</td>\n",
       "      <td>1 BEDFORD PARK AVE</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2009</td>\n",
       "      <td>1</td>\n",
       "      <td>1 BRUNSWICK AVE</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2009</td>\n",
       "      <td>1</td>\n",
       "      <td>1 CHARLESWOOD DR</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   year  infraction_code           location2  count\n",
       "0  2009                1      1 ALBERTUS AVE      2\n",
       "1  2009                1         1 BANGOR RD      1\n",
       "2  2009                1  1 BEDFORD PARK AVE      1\n",
       "3  2009                1     1 BRUNSWICK AVE     13\n",
       "4  2009                1    1 CHARLESWOOD DR      3"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "print(tpt_grouped_df.shape)\n",
    "tpt_grouped_df.head()\n",
    "# tpt_grouped_df[tpt_grouped_df['year']==2015]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {
    "collapsed": false,
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "fine_dict = {str(ic):{'fine_amt':tpt_df[tpt_df['infraction_code']==ic].set_fine_amount.median(),\n",
    "                      'fine_descp':tpt_df[tpt_df['infraction_code']==ic].infraction_description.iloc[0]}    \n",
    "                          for ic in infraction_ids} ##json only accepts strings for keys..."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {
    "collapsed": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>year</th>\n",
       "      <th>infraction_code</th>\n",
       "      <th>location2</th>\n",
       "      <th>count</th>\n",
       "      <th>fine_sum</th>\n",
       "      <th>fine_descrp</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>44625</th>\n",
       "      <td>2009</td>\n",
       "      <td>3</td>\n",
       "      <td>1750 FINCH AVE E</td>\n",
       "      <td>8669</td>\n",
       "      <td>260070.0</td>\n",
       "      <td>PARK/LEAVE ON PRIVATE PROPERTY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>48535</th>\n",
       "      <td>2009</td>\n",
       "      <td>3</td>\n",
       "      <td>25 THE WEST MALL</td>\n",
       "      <td>6698</td>\n",
       "      <td>200940.0</td>\n",
       "      <td>PARK/LEAVE ON PRIVATE PROPERTY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46510</th>\n",
       "      <td>2009</td>\n",
       "      <td>3</td>\n",
       "      <td>2075 BAYVIEW AVE</td>\n",
       "      <td>6312</td>\n",
       "      <td>189360.0</td>\n",
       "      <td>PARK/LEAVE ON PRIVATE PROPERTY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>82561</th>\n",
       "      <td>2009</td>\n",
       "      <td>5</td>\n",
       "      <td>20 EDWARD ST</td>\n",
       "      <td>4400</td>\n",
       "      <td>176000.0</td>\n",
       "      <td>PARK HWY PROHIBED TIME/DAY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>363861</th>\n",
       "      <td>2009</td>\n",
       "      <td>347</td>\n",
       "      <td>5100 YONGE ST</td>\n",
       "      <td>501</td>\n",
       "      <td>125250.0</td>\n",
       "      <td>PARK IN A FIRE ROUTE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>363608</th>\n",
       "      <td>2009</td>\n",
       "      <td>347</td>\n",
       "      <td>45 OVERLEA BLVD</td>\n",
       "      <td>474</td>\n",
       "      <td>118500.0</td>\n",
       "      <td>PARK IN A FIRE ROUTE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>172846</th>\n",
       "      <td>2009</td>\n",
       "      <td>9</td>\n",
       "      <td>60 GROSVENOR ST</td>\n",
       "      <td>1807</td>\n",
       "      <td>108420.0</td>\n",
       "      <td>STOP HWY PROHIBITED TIME/DAY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46509</th>\n",
       "      <td>2009</td>\n",
       "      <td>3</td>\n",
       "      <td>2075 BAYVIEW AV</td>\n",
       "      <td>3542</td>\n",
       "      <td>106260.0</td>\n",
       "      <td>PARK/LEAVE ON PRIVATE PROPERTY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>362448</th>\n",
       "      <td>2009</td>\n",
       "      <td>347</td>\n",
       "      <td>25 THE WEST MALL</td>\n",
       "      <td>425</td>\n",
       "      <td>106250.0</td>\n",
       "      <td>PARK IN A FIRE ROUTE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>362874</th>\n",
       "      <td>2009</td>\n",
       "      <td>347</td>\n",
       "      <td>300 BOROUGH DR</td>\n",
       "      <td>375</td>\n",
       "      <td>93750.0</td>\n",
       "      <td>PARK IN A FIRE ROUTE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>367066</th>\n",
       "      <td>2009</td>\n",
       "      <td>363</td>\n",
       "      <td>2161 QUEEN ST E</td>\n",
       "      <td>207</td>\n",
       "      <td>93150.0</td>\n",
       "      <td>PARK ON-STRT DISABLD NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>367185</th>\n",
       "      <td>2009</td>\n",
       "      <td>363</td>\n",
       "      <td>34 LITTLE NORWAY CRES</td>\n",
       "      <td>205</td>\n",
       "      <td>92250.0</td>\n",
       "      <td>PARK ON-STRT DISABLD NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>363714</th>\n",
       "      <td>2009</td>\n",
       "      <td>347</td>\n",
       "      <td>4968 YONGE ST</td>\n",
       "      <td>366</td>\n",
       "      <td>91500.0</td>\n",
       "      <td>PARK IN A FIRE ROUTE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>363102</th>\n",
       "      <td>2009</td>\n",
       "      <td>347</td>\n",
       "      <td>3401 DUFFERIN ST</td>\n",
       "      <td>355</td>\n",
       "      <td>88750.0</td>\n",
       "      <td>PARK IN A FIRE ROUTE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>366073</th>\n",
       "      <td>2009</td>\n",
       "      <td>355</td>\n",
       "      <td>555 REXDALE BLVD</td>\n",
       "      <td>197</td>\n",
       "      <td>88650.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>154392</th>\n",
       "      <td>2009</td>\n",
       "      <td>8</td>\n",
       "      <td>244 VICTORIA ST</td>\n",
       "      <td>1424</td>\n",
       "      <td>85440.0</td>\n",
       "      <td>STD VEH HWY PROHIB TIME/DAY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>165079</th>\n",
       "      <td>2009</td>\n",
       "      <td>9</td>\n",
       "      <td>200 ELIZABETH ST</td>\n",
       "      <td>1378</td>\n",
       "      <td>82680.0</td>\n",
       "      <td>STOP HWY PROHIBITED TIME/DAY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>159180</th>\n",
       "      <td>2009</td>\n",
       "      <td>9</td>\n",
       "      <td>100 YORKVILLE AVE</td>\n",
       "      <td>1335</td>\n",
       "      <td>80100.0</td>\n",
       "      <td>STOP HWY PROHIBITED TIME/DAY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>362950</th>\n",
       "      <td>2009</td>\n",
       "      <td>347</td>\n",
       "      <td>31 TAPSCOTT RD</td>\n",
       "      <td>318</td>\n",
       "      <td>79500.0</td>\n",
       "      <td>PARK IN A FIRE ROUTE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>367711</th>\n",
       "      <td>2009</td>\n",
       "      <td>367</td>\n",
       "      <td>410 COLLEGE ST</td>\n",
       "      <td>176</td>\n",
       "      <td>79200.0</td>\n",
       "      <td>STAND ON-ST DISABL LDG NO PRMT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46998</th>\n",
       "      <td>2009</td>\n",
       "      <td>3</td>\n",
       "      <td>2181 YONGE ST</td>\n",
       "      <td>2624</td>\n",
       "      <td>78720.0</td>\n",
       "      <td>PARK/LEAVE ON PRIVATE PROPERTY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42404</th>\n",
       "      <td>2009</td>\n",
       "      <td>3</td>\n",
       "      <td>1265 MILITARY TRAIL</td>\n",
       "      <td>2614</td>\n",
       "      <td>78420.0</td>\n",
       "      <td>PARK/LEAVE ON PRIVATE PROPERTY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>152520</th>\n",
       "      <td>2009</td>\n",
       "      <td>8</td>\n",
       "      <td>15 ASQUITH AVE</td>\n",
       "      <td>1296</td>\n",
       "      <td>77760.0</td>\n",
       "      <td>STD VEH HWY PROHIB TIME/DAY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>176182</th>\n",
       "      <td>2009</td>\n",
       "      <td>9</td>\n",
       "      <td>92 YORKVILLE AVE</td>\n",
       "      <td>1277</td>\n",
       "      <td>76620.0</td>\n",
       "      <td>STOP HWY PROHIBITED TIME/DAY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>60256</th>\n",
       "      <td>2009</td>\n",
       "      <td>4</td>\n",
       "      <td>4050 YONGE ST</td>\n",
       "      <td>2540</td>\n",
       "      <td>76200.0</td>\n",
       "      <td>PARK/LEAVE ON MUNICIPAL PRPTY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>153697</th>\n",
       "      <td>2009</td>\n",
       "      <td>8</td>\n",
       "      <td>200 KING ST E</td>\n",
       "      <td>1264</td>\n",
       "      <td>75840.0</td>\n",
       "      <td>STD VEH HWY PROHIB TIME/DAY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>367818</th>\n",
       "      <td>2009</td>\n",
       "      <td>369</td>\n",
       "      <td>401 COLLEGE ST</td>\n",
       "      <td>167</td>\n",
       "      <td>75150.0</td>\n",
       "      <td>STAND STR DISABL LDG NO DROPOF</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364688</th>\n",
       "      <td>2009</td>\n",
       "      <td>347</td>\n",
       "      <td>900 DUFFERIN ST</td>\n",
       "      <td>292</td>\n",
       "      <td>73000.0</td>\n",
       "      <td>PARK IN A FIRE ROUTE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>173533</th>\n",
       "      <td>2009</td>\n",
       "      <td>9</td>\n",
       "      <td>66 WELLINGTON ST W</td>\n",
       "      <td>1185</td>\n",
       "      <td>71100.0</td>\n",
       "      <td>STOP HWY PROHIBITED TIME/DAY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>156738</th>\n",
       "      <td>2009</td>\n",
       "      <td>8</td>\n",
       "      <td>5140 YONGE ST</td>\n",
       "      <td>1086</td>\n",
       "      <td>65160.0</td>\n",
       "      <td>STD VEH HWY PROHIB TIME/DAY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364910</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>190 WOOLER AV</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364923</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>2347 KENNED RD N</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364922</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>2296 LAWRENCE AVE E</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364921</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>2265 JANE ST</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364920</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>2257 ISLINGTON AVE</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364919</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>2195 JANE ST</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364918</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>2100 ELLESMERE ROAD</td>\n",
       "      <td>2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364917</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>201 ELIZABETH ST</td>\n",
       "      <td>3</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364916</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>200 TOWN CENTRE CT</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364915</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>200 TOWN CENTRE CRT.</td>\n",
       "      <td>3</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364914</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>2 CHURCH ST</td>\n",
       "      <td>5</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364913</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>1961 KENNEDY RD</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364912</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>190 WOOLNER AVE</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364911</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>190 WOOLNER AV</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364909</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>19 WOOLNER AVE</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364895</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>13 ISABELLA STREET</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364908</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>1780 MARKHAM RD</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364907</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>160 BLOOR ST E</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364906</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>1571 SANDHURST CIRCLE</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364905</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>1571 SANDHURST CIR</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364904</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>155 NEPTUNE DR</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364903</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>1530 MARKHAM RD</td>\n",
       "      <td>2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364902</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>150 RIVER ST</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364901</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>15 DENISON AVE</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364900</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>15 DENISON AV</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364899</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>145 NEPTUNE DRIVE</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364898</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>145 NEPTUNE DR</td>\n",
       "      <td>3</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364897</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>1411 FINCH AVE W</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364896</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>14 ARUNDEL AVENUE</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364934</th>\n",
       "      <td>2009</td>\n",
       "      <td>348</td>\n",
       "      <td>29 LOUVAIN AVE</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>367838 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        year  infraction_code              location2  count  fine_sum  \\\n",
       "44625   2009                3       1750 FINCH AVE E   8669  260070.0   \n",
       "48535   2009                3       25 THE WEST MALL   6698  200940.0   \n",
       "46510   2009                3       2075 BAYVIEW AVE   6312  189360.0   \n",
       "82561   2009                5           20 EDWARD ST   4400  176000.0   \n",
       "363861  2009              347          5100 YONGE ST    501  125250.0   \n",
       "363608  2009              347        45 OVERLEA BLVD    474  118500.0   \n",
       "172846  2009                9        60 GROSVENOR ST   1807  108420.0   \n",
       "46509   2009                3        2075 BAYVIEW AV   3542  106260.0   \n",
       "362448  2009              347       25 THE WEST MALL    425  106250.0   \n",
       "362874  2009              347         300 BOROUGH DR    375   93750.0   \n",
       "367066  2009              363        2161 QUEEN ST E    207   93150.0   \n",
       "367185  2009              363  34 LITTLE NORWAY CRES    205   92250.0   \n",
       "363714  2009              347          4968 YONGE ST    366   91500.0   \n",
       "363102  2009              347       3401 DUFFERIN ST    355   88750.0   \n",
       "366073  2009              355       555 REXDALE BLVD    197   88650.0   \n",
       "154392  2009                8        244 VICTORIA ST   1424   85440.0   \n",
       "165079  2009                9       200 ELIZABETH ST   1378   82680.0   \n",
       "159180  2009                9      100 YORKVILLE AVE   1335   80100.0   \n",
       "362950  2009              347         31 TAPSCOTT RD    318   79500.0   \n",
       "367711  2009              367         410 COLLEGE ST    176   79200.0   \n",
       "46998   2009                3          2181 YONGE ST   2624   78720.0   \n",
       "42404   2009                3    1265 MILITARY TRAIL   2614   78420.0   \n",
       "152520  2009                8         15 ASQUITH AVE   1296   77760.0   \n",
       "176182  2009                9       92 YORKVILLE AVE   1277   76620.0   \n",
       "60256   2009                4          4050 YONGE ST   2540   76200.0   \n",
       "153697  2009                8          200 KING ST E   1264   75840.0   \n",
       "367818  2009              369         401 COLLEGE ST    167   75150.0   \n",
       "364688  2009              347        900 DUFFERIN ST    292   73000.0   \n",
       "173533  2009                9     66 WELLINGTON ST W   1185   71100.0   \n",
       "156738  2009                8          5140 YONGE ST   1086   65160.0   \n",
       "...      ...              ...                    ...    ...       ...   \n",
       "364910  2009              348          190 WOOLER AV      1       0.0   \n",
       "364923  2009              348       2347 KENNED RD N      1       0.0   \n",
       "364922  2009              348    2296 LAWRENCE AVE E      1       0.0   \n",
       "364921  2009              348           2265 JANE ST      1       0.0   \n",
       "364920  2009              348     2257 ISLINGTON AVE      1       0.0   \n",
       "364919  2009              348           2195 JANE ST      1       0.0   \n",
       "364918  2009              348    2100 ELLESMERE ROAD      2       0.0   \n",
       "364917  2009              348       201 ELIZABETH ST      3       0.0   \n",
       "364916  2009              348     200 TOWN CENTRE CT      1       0.0   \n",
       "364915  2009              348   200 TOWN CENTRE CRT.      3       0.0   \n",
       "364914  2009              348            2 CHURCH ST      5       0.0   \n",
       "364913  2009              348        1961 KENNEDY RD      1       0.0   \n",
       "364912  2009              348        190 WOOLNER AVE      1       0.0   \n",
       "364911  2009              348         190 WOOLNER AV      1       0.0   \n",
       "364909  2009              348         19 WOOLNER AVE      1       0.0   \n",
       "364895  2009              348     13 ISABELLA STREET      1       0.0   \n",
       "364908  2009              348        1780 MARKHAM RD      1       0.0   \n",
       "364907  2009              348         160 BLOOR ST E      1       0.0   \n",
       "364906  2009              348  1571 SANDHURST CIRCLE      1       0.0   \n",
       "364905  2009              348     1571 SANDHURST CIR      1       0.0   \n",
       "364904  2009              348         155 NEPTUNE DR      1       0.0   \n",
       "364903  2009              348        1530 MARKHAM RD      2       0.0   \n",
       "364902  2009              348           150 RIVER ST      1       0.0   \n",
       "364901  2009              348         15 DENISON AVE      1       0.0   \n",
       "364900  2009              348          15 DENISON AV      1       0.0   \n",
       "364899  2009              348      145 NEPTUNE DRIVE      1       0.0   \n",
       "364898  2009              348         145 NEPTUNE DR      3       0.0   \n",
       "364897  2009              348       1411 FINCH AVE W      1       0.0   \n",
       "364896  2009              348      14 ARUNDEL AVENUE      1       0.0   \n",
       "364934  2009              348         29 LOUVAIN AVE      1       0.0   \n",
       "\n",
       "                           fine_descrp  \n",
       "44625   PARK/LEAVE ON PRIVATE PROPERTY  \n",
       "48535   PARK/LEAVE ON PRIVATE PROPERTY  \n",
       "46510   PARK/LEAVE ON PRIVATE PROPERTY  \n",
       "82561       PARK HWY PROHIBED TIME/DAY  \n",
       "363861            PARK IN A FIRE ROUTE  \n",
       "363608            PARK IN A FIRE ROUTE  \n",
       "172846    STOP HWY PROHIBITED TIME/DAY  \n",
       "46509   PARK/LEAVE ON PRIVATE PROPERTY  \n",
       "362448            PARK IN A FIRE ROUTE  \n",
       "362874            PARK IN A FIRE ROUTE  \n",
       "367066  PARK ON-STRT DISABLD NO PERMIT  \n",
       "367185  PARK ON-STRT DISABLD NO PERMIT  \n",
       "363714            PARK IN A FIRE ROUTE  \n",
       "363102            PARK IN A FIRE ROUTE  \n",
       "366073      PARK IN DISABLED NO PERMIT  \n",
       "154392     STD VEH HWY PROHIB TIME/DAY  \n",
       "165079    STOP HWY PROHIBITED TIME/DAY  \n",
       "159180    STOP HWY PROHIBITED TIME/DAY  \n",
       "362950            PARK IN A FIRE ROUTE  \n",
       "367711  STAND ON-ST DISABL LDG NO PRMT  \n",
       "46998   PARK/LEAVE ON PRIVATE PROPERTY  \n",
       "42404   PARK/LEAVE ON PRIVATE PROPERTY  \n",
       "152520     STD VEH HWY PROHIB TIME/DAY  \n",
       "176182    STOP HWY PROHIBITED TIME/DAY  \n",
       "60256    PARK/LEAVE ON MUNICIPAL PRPTY  \n",
       "153697     STD VEH HWY PROHIB TIME/DAY  \n",
       "367818  STAND STR DISABL LDG NO DROPOF  \n",
       "364688            PARK IN A FIRE ROUTE  \n",
       "173533    STOP HWY PROHIBITED TIME/DAY  \n",
       "156738     STD VEH HWY PROHIB TIME/DAY  \n",
       "...                                ...  \n",
       "364910      PARK IN DISABLED NO PERMIT  \n",
       "364923      PARK IN DISABLED NO PERMIT  \n",
       "364922      PARK IN DISABLED NO PERMIT  \n",
       "364921      PARK IN DISABLED NO PERMIT  \n",
       "364920      PARK IN DISABLED NO PERMIT  \n",
       "364919      PARK IN DISABLED NO PERMIT  \n",
       "364918      PARK IN DISABLED NO PERMIT  \n",
       "364917      PARK IN DISABLED NO PERMIT  \n",
       "364916      PARK IN DISABLED NO PERMIT  \n",
       "364915      PARK IN DISABLED NO PERMIT  \n",
       "364914      PARK IN DISABLED NO PERMIT  \n",
       "364913      PARK IN DISABLED NO PERMIT  \n",
       "364912      PARK IN DISABLED NO PERMIT  \n",
       "364911      PARK IN DISABLED NO PERMIT  \n",
       "364909      PARK IN DISABLED NO PERMIT  \n",
       "364895      PARK IN DISABLED NO PERMIT  \n",
       "364908      PARK IN DISABLED NO PERMIT  \n",
       "364907      PARK IN DISABLED NO PERMIT  \n",
       "364906      PARK IN DISABLED NO PERMIT  \n",
       "364905      PARK IN DISABLED NO PERMIT  \n",
       "364904      PARK IN DISABLED NO PERMIT  \n",
       "364903      PARK IN DISABLED NO PERMIT  \n",
       "364902      PARK IN DISABLED NO PERMIT  \n",
       "364901      PARK IN DISABLED NO PERMIT  \n",
       "364900      PARK IN DISABLED NO PERMIT  \n",
       "364899      PARK IN DISABLED NO PERMIT  \n",
       "364898      PARK IN DISABLED NO PERMIT  \n",
       "364897      PARK IN DISABLED NO PERMIT  \n",
       "364896      PARK IN DISABLED NO PERMIT  \n",
       "364934      PARK IN DISABLED NO PERMIT  \n",
       "\n",
       "[367838 rows x 6 columns]"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "##now calculate total amount...\n",
    "##create dict of infraction_code:fine_amount\n",
    "fine_amount_dict={ic:{'fine_amt':tpt_df[tpt_df['infraction_code']==ic].set_fine_amount.median(),\n",
    "                      'fine_descp':tpt_df[tpt_df['infraction_code']==ic].infraction_description.iloc[0]}    \n",
    "                          for ic in infraction_ids}\n",
    "\n",
    "def calc_fine_sum(df):\n",
    "    return df['count']*fine_amount_dict[df['infraction_code']]['fine_amt']\n",
    "\n",
    "def get_fine_descrp(df):\n",
    "    return fine_amount_dict[df['infraction_code']]['fine_descp']\n",
    "\n",
    "\n",
    "tpt_grouped_df['fine_sum']=tpt_grouped_df.apply(calc_fine_sum,axis=1)\n",
    "tpt_grouped_df['fine_descrp']=tpt_grouped_df.apply(get_fine_descrp,axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>year</th>\n",
       "      <th>infraction_code</th>\n",
       "      <th>location2</th>\n",
       "      <th>count</th>\n",
       "      <th>fine_sum</th>\n",
       "      <th>fine_descrp</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>44625</th>\n",
       "      <td>2009</td>\n",
       "      <td>3</td>\n",
       "      <td>1750 FINCH AVE E</td>\n",
       "      <td>8669</td>\n",
       "      <td>260070.0</td>\n",
       "      <td>PARK/LEAVE ON PRIVATE PROPERTY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>48535</th>\n",
       "      <td>2009</td>\n",
       "      <td>3</td>\n",
       "      <td>25 THE WEST MALL</td>\n",
       "      <td>6698</td>\n",
       "      <td>200940.0</td>\n",
       "      <td>PARK/LEAVE ON PRIVATE PROPERTY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46510</th>\n",
       "      <td>2009</td>\n",
       "      <td>3</td>\n",
       "      <td>2075 BAYVIEW AVE</td>\n",
       "      <td>6312</td>\n",
       "      <td>189360.0</td>\n",
       "      <td>PARK/LEAVE ON PRIVATE PROPERTY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>82561</th>\n",
       "      <td>2009</td>\n",
       "      <td>5</td>\n",
       "      <td>20 EDWARD ST</td>\n",
       "      <td>4400</td>\n",
       "      <td>176000.0</td>\n",
       "      <td>PARK HWY PROHIBED TIME/DAY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>363861</th>\n",
       "      <td>2009</td>\n",
       "      <td>347</td>\n",
       "      <td>5100 YONGE ST</td>\n",
       "      <td>501</td>\n",
       "      <td>125250.0</td>\n",
       "      <td>PARK IN A FIRE ROUTE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>363608</th>\n",
       "      <td>2009</td>\n",
       "      <td>347</td>\n",
       "      <td>45 OVERLEA BLVD</td>\n",
       "      <td>474</td>\n",
       "      <td>118500.0</td>\n",
       "      <td>PARK IN A FIRE ROUTE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>172846</th>\n",
       "      <td>2009</td>\n",
       "      <td>9</td>\n",
       "      <td>60 GROSVENOR ST</td>\n",
       "      <td>1807</td>\n",
       "      <td>108420.0</td>\n",
       "      <td>STOP HWY PROHIBITED TIME/DAY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46509</th>\n",
       "      <td>2009</td>\n",
       "      <td>3</td>\n",
       "      <td>2075 BAYVIEW AV</td>\n",
       "      <td>3542</td>\n",
       "      <td>106260.0</td>\n",
       "      <td>PARK/LEAVE ON PRIVATE PROPERTY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>362448</th>\n",
       "      <td>2009</td>\n",
       "      <td>347</td>\n",
       "      <td>25 THE WEST MALL</td>\n",
       "      <td>425</td>\n",
       "      <td>106250.0</td>\n",
       "      <td>PARK IN A FIRE ROUTE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>362874</th>\n",
       "      <td>2009</td>\n",
       "      <td>347</td>\n",
       "      <td>300 BOROUGH DR</td>\n",
       "      <td>375</td>\n",
       "      <td>93750.0</td>\n",
       "      <td>PARK IN A FIRE ROUTE</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        year  infraction_code         location2  count  fine_sum  \\\n",
       "44625   2009                3  1750 FINCH AVE E   8669  260070.0   \n",
       "48535   2009                3  25 THE WEST MALL   6698  200940.0   \n",
       "46510   2009                3  2075 BAYVIEW AVE   6312  189360.0   \n",
       "82561   2009                5      20 EDWARD ST   4400  176000.0   \n",
       "363861  2009              347     5100 YONGE ST    501  125250.0   \n",
       "363608  2009              347   45 OVERLEA BLVD    474  118500.0   \n",
       "172846  2009                9   60 GROSVENOR ST   1807  108420.0   \n",
       "46509   2009                3   2075 BAYVIEW AV   3542  106260.0   \n",
       "362448  2009              347  25 THE WEST MALL    425  106250.0   \n",
       "362874  2009              347    300 BOROUGH DR    375   93750.0   \n",
       "\n",
       "                           fine_descrp  \n",
       "44625   PARK/LEAVE ON PRIVATE PROPERTY  \n",
       "48535   PARK/LEAVE ON PRIVATE PROPERTY  \n",
       "46510   PARK/LEAVE ON PRIVATE PROPERTY  \n",
       "82561       PARK HWY PROHIBED TIME/DAY  \n",
       "363861            PARK IN A FIRE ROUTE  \n",
       "363608            PARK IN A FIRE ROUTE  \n",
       "172846    STOP HWY PROHIBITED TIME/DAY  \n",
       "46509   PARK/LEAVE ON PRIVATE PROPERTY  \n",
       "362448            PARK IN A FIRE ROUTE  \n",
       "362874            PARK IN A FIRE ROUTE  "
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tpt_grouped_df.sort_values('fine_sum',ascending=False)[0:10]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This is wild...so in 2015 there were 1889 parking tickets issued at one location (1090 Don Mills Rd).\n",
    "\n",
    "That's just over 5 tickets a day on average...and that's if you assume every day at the mall/this location has the same traffic..which is probably not true. In reality, this would be concentrated on weekends so it could be something like 10-20 tickets (random guess) on weekends.\n",
    "\n",
    "If you assume each ticketed vehicle is there for at least an hour...that's a good chunk of the day where the fire route is at least partially blocked..obviously this needs to be treated more as an actual safety concern and less as an incredible revenue generating source for Toronto's municipal government. \n",
    "\n",
    "Obviously this rule is not clear...I don't think people would risk a 250 ticket just to get a closer parking spot..this spot (and likely many others) clearly needs better labelling. Putting a sign on the wall is one thing...how about the government takes 20 from the 472,250 they earned in 2015 alone (okay, maybe 50 percent of the people fought their tickets or didn't pay them...only 236,125) and puts some red paint on the pavement. \n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[{251: 'LEAVE IN PARK NOT DESIG AREA'},\n",
       " {252: 'PARK IN PARK - PROHIBITED AREA'},\n",
       " {258: 'STOP CONTRARY POSTED CONDITION'},\n",
       " {348: 'PARK IN DISABLED NO PERMIT'},\n",
       " {349: 'PARK IN DISABLED NOT DROP OFF'},\n",
       " {350: 'PARK DISABLD LOADING NO PERMIT'},\n",
       " {351: 'PARK DISABLD LDG NOT DROP OFF'},\n",
       " {352: 'PARK ON-STRT DISABLD NO PERMIT'},\n",
       " {353: 'PARK ON-ST DISABLD LDG NO PRMT'}]"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "[{infrac_type:infrac_dict['fine_descp']} for infrac_type, infrac_dict in fine_amount_dict.items() \n",
    "     if infrac_dict['fine_amt']==0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date_of_infraction</th>\n",
       "      <th>infraction_code</th>\n",
       "      <th>infraction_description</th>\n",
       "      <th>set_fine_amount</th>\n",
       "      <th>time_of_infraction</th>\n",
       "      <th>location1</th>\n",
       "      <th>location2</th>\n",
       "      <th>year</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>3670</th>\n",
       "      <td>20090102</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1124.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>100 BISHOP AVE</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10272</th>\n",
       "      <td>20090103</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>745.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>341 OAKWOOD AVE</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24782</th>\n",
       "      <td>20090105</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1246.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4001 LESLIE ST</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25612</th>\n",
       "      <td>20090105</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1405.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>399 LAKE SHORE BLVD WEST</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25873</th>\n",
       "      <td>20090105</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1432.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3199 LAKE SHORE BLVD WEST</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26211</th>\n",
       "      <td>20090105</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1515.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3030 LAWRENCE AVE</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26301</th>\n",
       "      <td>20090105</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1524.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3030 LAWRENCE AVE</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27484</th>\n",
       "      <td>20090105</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1751.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>123 REXDALE BLVD</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32107</th>\n",
       "      <td>20090106</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1110.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3030 LAWRENCE AVE</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32219</th>\n",
       "      <td>20090106</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1120.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3030 LAWRENCE AVE</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>33369</th>\n",
       "      <td>20090106</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1251.0</td>\n",
       "      <td>AT</td>\n",
       "      <td>250 WINCOTT DR</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55319</th>\n",
       "      <td>20090109</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1300.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4001 LESLIE ST</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55396</th>\n",
       "      <td>20090109</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1305.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4001 LESLIE ST</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>61842</th>\n",
       "      <td>20090110</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>922.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>90 MORNELLE COURT</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>73342</th>\n",
       "      <td>20090112</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1127.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1030 SHEPPARD AVE W</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>73369</th>\n",
       "      <td>20090112</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1130.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1030 SHEPPARD AVE W</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>83731</th>\n",
       "      <td>20090113</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1549.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>10 HARLANDALE AVE</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>87568</th>\n",
       "      <td>20090114</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1000.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>150 RIVER ST</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>89695</th>\n",
       "      <td>20090114</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1336.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1200 MARKHAM RD</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>95353</th>\n",
       "      <td>20090115</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1247.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>15 DENISON AVE</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>103914</th>\n",
       "      <td>20090116</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1605.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3030 LAWRENCE AVE</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>105137</th>\n",
       "      <td>20090116</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1951.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>730 MT PLEASANT RD</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>113322</th>\n",
       "      <td>20090118</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>400.0</td>\n",
       "      <td>AT</td>\n",
       "      <td>1961 KENNEDY RD</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>123151</th>\n",
       "      <td>20090119</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1926.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>300 BOROUGH DR</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>123599</th>\n",
       "      <td>20090119</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>2035.0</td>\n",
       "      <td>AT</td>\n",
       "      <td>190 WOOLNER AVE</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>123645</th>\n",
       "      <td>20090119</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>2043.0</td>\n",
       "      <td>AT</td>\n",
       "      <td>1001 ROSELAWN AVE</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>131564</th>\n",
       "      <td>20090120</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>2044.0</td>\n",
       "      <td>NEAR</td>\n",
       "      <td>MARKHAM RD</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>143501</th>\n",
       "      <td>20090122</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>946.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3030 LAWRENCE AVE</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>145073</th>\n",
       "      <td>20090122</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1159.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5801 YONGE ST</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>147890</th>\n",
       "      <td>20090122</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1552.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>941 PROGRESS AVE</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1692713</th>\n",
       "      <td>20090901</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1010.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>201 ELIZABETH ST</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1692901</th>\n",
       "      <td>20090901</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1026.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2 CHURCH ST</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1785933</th>\n",
       "      <td>20090914</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1033.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1200 MARKHAM ROAD</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1811662</th>\n",
       "      <td>20090917</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1357.0</td>\n",
       "      <td>AT</td>\n",
       "      <td>1132 LESLIE ST</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1890153</th>\n",
       "      <td>20090927</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>910.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>375 BLEECKER ST</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1911432</th>\n",
       "      <td>20090930</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>405.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>375 BLEECKER ST</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1928203</th>\n",
       "      <td>20091001</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>2205.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>7A CHURCH ST</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1946514</th>\n",
       "      <td>20091004</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1112.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2265 JANE ST</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1976630</th>\n",
       "      <td>20091008</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1031.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1200 MARKHAM RD</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1977028</th>\n",
       "      <td>20091008</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1116.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2100 ELLESMERE ROAD</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025959</th>\n",
       "      <td>20091015</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1233.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3199 LAKESHORE BLVD W</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2145788</th>\n",
       "      <td>20091031</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>937.0</td>\n",
       "      <td>AT</td>\n",
       "      <td>145 NEPTUNE DRIVE</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2157957</th>\n",
       "      <td>20091102</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>700.0</td>\n",
       "      <td>AT</td>\n",
       "      <td>145 NEPTUNE DR</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2170301</th>\n",
       "      <td>20091103</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1552.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3401 DUFFERIN ST</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2236055</th>\n",
       "      <td>20091112</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1215.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4022 SHEPPARD AV E</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2269568</th>\n",
       "      <td>20091116</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1737.0</td>\n",
       "      <td>AT</td>\n",
       "      <td>WEDLEWOOD DR</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2323330</th>\n",
       "      <td>20091123</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>2106.0</td>\n",
       "      <td>AT</td>\n",
       "      <td>4002 SHEPAPRD AVE E</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2323331</th>\n",
       "      <td>20091123</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>2106.0</td>\n",
       "      <td>AT</td>\n",
       "      <td>4002 SHEPPARD AVE E</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2351588</th>\n",
       "      <td>20091127</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1720.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>785 MILNER AVE</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2351733</th>\n",
       "      <td>20091127</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1745.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>785 MILNER AVE</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2351895</th>\n",
       "      <td>20091127</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1820.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>785 MILNER AVE</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2352437</th>\n",
       "      <td>20091127</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>2015.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>785 MILNER AVE</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2353214</th>\n",
       "      <td>20091127</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>785 MILNER AVE</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2462668</th>\n",
       "      <td>20091212</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1145.0</td>\n",
       "      <td>AT</td>\n",
       "      <td>145 NEPTUNE DR</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2469454</th>\n",
       "      <td>20091213</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1014.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>190 WOOLER AV</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2545535</th>\n",
       "      <td>20091223</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1327.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>19 WOOLNER AVE</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2545569</th>\n",
       "      <td>20091223</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1331.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>190 WOOLNER AV</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2559484</th>\n",
       "      <td>20091227</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1342.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5117 SHEPPARD AV E</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2565657</th>\n",
       "      <td>20091229</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1030.0</td>\n",
       "      <td>AT</td>\n",
       "      <td>700 LAWRENCE AV W</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2565748</th>\n",
       "      <td>20091229</td>\n",
       "      <td>348</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1055.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>85 HANNA AVE</td>\n",
       "      <td>2009</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>159 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         date_of_infraction  infraction_code      infraction_description  \\\n",
       "3670               20090102              348  PARK IN DISABLED NO PERMIT   \n",
       "10272              20090103              348  PARK IN DISABLED NO PERMIT   \n",
       "24782              20090105              348  PARK IN DISABLED NO PERMIT   \n",
       "25612              20090105              348  PARK IN DISABLED NO PERMIT   \n",
       "25873              20090105              348  PARK IN DISABLED NO PERMIT   \n",
       "26211              20090105              348  PARK IN DISABLED NO PERMIT   \n",
       "26301              20090105              348  PARK IN DISABLED NO PERMIT   \n",
       "27484              20090105              348  PARK IN DISABLED NO PERMIT   \n",
       "32107              20090106              348  PARK IN DISABLED NO PERMIT   \n",
       "32219              20090106              348  PARK IN DISABLED NO PERMIT   \n",
       "33369              20090106              348  PARK IN DISABLED NO PERMIT   \n",
       "55319              20090109              348  PARK IN DISABLED NO PERMIT   \n",
       "55396              20090109              348  PARK IN DISABLED NO PERMIT   \n",
       "61842              20090110              348  PARK IN DISABLED NO PERMIT   \n",
       "73342              20090112              348  PARK IN DISABLED NO PERMIT   \n",
       "73369              20090112              348  PARK IN DISABLED NO PERMIT   \n",
       "83731              20090113              348  PARK IN DISABLED NO PERMIT   \n",
       "87568              20090114              348  PARK IN DISABLED NO PERMIT   \n",
       "89695              20090114              348  PARK IN DISABLED NO PERMIT   \n",
       "95353              20090115              348  PARK IN DISABLED NO PERMIT   \n",
       "103914             20090116              348  PARK IN DISABLED NO PERMIT   \n",
       "105137             20090116              348  PARK IN DISABLED NO PERMIT   \n",
       "113322             20090118              348  PARK IN DISABLED NO PERMIT   \n",
       "123151             20090119              348  PARK IN DISABLED NO PERMIT   \n",
       "123599             20090119              348  PARK IN DISABLED NO PERMIT   \n",
       "123645             20090119              348  PARK IN DISABLED NO PERMIT   \n",
       "131564             20090120              348  PARK IN DISABLED NO PERMIT   \n",
       "143501             20090122              348  PARK IN DISABLED NO PERMIT   \n",
       "145073             20090122              348  PARK IN DISABLED NO PERMIT   \n",
       "147890             20090122              348  PARK IN DISABLED NO PERMIT   \n",
       "...                     ...              ...                         ...   \n",
       "1692713            20090901              348  PARK IN DISABLED NO PERMIT   \n",
       "1692901            20090901              348  PARK IN DISABLED NO PERMIT   \n",
       "1785933            20090914              348  PARK IN DISABLED NO PERMIT   \n",
       "1811662            20090917              348  PARK IN DISABLED NO PERMIT   \n",
       "1890153            20090927              348  PARK IN DISABLED NO PERMIT   \n",
       "1911432            20090930              348  PARK IN DISABLED NO PERMIT   \n",
       "1928203            20091001              348  PARK IN DISABLED NO PERMIT   \n",
       "1946514            20091004              348  PARK IN DISABLED NO PERMIT   \n",
       "1976630            20091008              348  PARK IN DISABLED NO PERMIT   \n",
       "1977028            20091008              348  PARK IN DISABLED NO PERMIT   \n",
       "2025959            20091015              348  PARK IN DISABLED NO PERMIT   \n",
       "2145788            20091031              348  PARK IN DISABLED NO PERMIT   \n",
       "2157957            20091102              348  PARK IN DISABLED NO PERMIT   \n",
       "2170301            20091103              348  PARK IN DISABLED NO PERMIT   \n",
       "2236055            20091112              348  PARK IN DISABLED NO PERMIT   \n",
       "2269568            20091116              348  PARK IN DISABLED NO PERMIT   \n",
       "2323330            20091123              348  PARK IN DISABLED NO PERMIT   \n",
       "2323331            20091123              348  PARK IN DISABLED NO PERMIT   \n",
       "2351588            20091127              348  PARK IN DISABLED NO PERMIT   \n",
       "2351733            20091127              348  PARK IN DISABLED NO PERMIT   \n",
       "2351895            20091127              348  PARK IN DISABLED NO PERMIT   \n",
       "2352437            20091127              348  PARK IN DISABLED NO PERMIT   \n",
       "2353214            20091127              348  PARK IN DISABLED NO PERMIT   \n",
       "2462668            20091212              348  PARK IN DISABLED NO PERMIT   \n",
       "2469454            20091213              348  PARK IN DISABLED NO PERMIT   \n",
       "2545535            20091223              348  PARK IN DISABLED NO PERMIT   \n",
       "2545569            20091223              348  PARK IN DISABLED NO PERMIT   \n",
       "2559484            20091227              348  PARK IN DISABLED NO PERMIT   \n",
       "2565657            20091229              348  PARK IN DISABLED NO PERMIT   \n",
       "2565748            20091229              348  PARK IN DISABLED NO PERMIT   \n",
       "\n",
       "         set_fine_amount  time_of_infraction location1  \\\n",
       "3670                   0              1124.0       NaN   \n",
       "10272                  0               745.0       NaN   \n",
       "24782                  0              1246.0       NaN   \n",
       "25612                  0              1405.0       NaN   \n",
       "25873                  0              1432.0       NaN   \n",
       "26211                  0              1515.0       NaN   \n",
       "26301                  0              1524.0       NaN   \n",
       "27484                  0              1751.0       NaN   \n",
       "32107                  0              1110.0       NaN   \n",
       "32219                  0              1120.0       NaN   \n",
       "33369                  0              1251.0        AT   \n",
       "55319                  0              1300.0       NaN   \n",
       "55396                  0              1305.0       NaN   \n",
       "61842                  0               922.0       NaN   \n",
       "73342                  0              1127.0       NaN   \n",
       "73369                  0              1130.0       NaN   \n",
       "83731                  0              1549.0       NaN   \n",
       "87568                  0              1000.0       NaN   \n",
       "89695                  0              1336.0       NaN   \n",
       "95353                  0              1247.0       NaN   \n",
       "103914                 0              1605.0       NaN   \n",
       "105137                 0              1951.0       NaN   \n",
       "113322                 0               400.0        AT   \n",
       "123151                 0              1926.0       NaN   \n",
       "123599                 0              2035.0        AT   \n",
       "123645                 0              2043.0        AT   \n",
       "131564                 0              2044.0      NEAR   \n",
       "143501                 0               946.0       NaN   \n",
       "145073                 0              1159.0       NaN   \n",
       "147890                 0              1552.0       NaN   \n",
       "...                  ...                 ...       ...   \n",
       "1692713                0              1010.0       NaN   \n",
       "1692901                0              1026.0       NaN   \n",
       "1785933                0              1033.0       NaN   \n",
       "1811662                0              1357.0        AT   \n",
       "1890153                0               910.0       NaN   \n",
       "1911432                0               405.0       NaN   \n",
       "1928203                0              2205.0       NaN   \n",
       "1946514                0              1112.0       NaN   \n",
       "1976630                0              1031.0       NaN   \n",
       "1977028                0              1116.0       NaN   \n",
       "2025959                0              1233.0       NaN   \n",
       "2145788                0               937.0        AT   \n",
       "2157957                0               700.0        AT   \n",
       "2170301                0              1552.0       NaN   \n",
       "2236055                0              1215.0       NaN   \n",
       "2269568                0              1737.0        AT   \n",
       "2323330                0              2106.0        AT   \n",
       "2323331                0              2106.0        AT   \n",
       "2351588                0              1720.0       NaN   \n",
       "2351733                0              1745.0       NaN   \n",
       "2351895                0              1820.0       NaN   \n",
       "2352437                0              2015.0       NaN   \n",
       "2353214                0                 NaN       NaN   \n",
       "2462668                0              1145.0        AT   \n",
       "2469454                0              1014.0       NaN   \n",
       "2545535                0              1327.0       NaN   \n",
       "2545569                0              1331.0       NaN   \n",
       "2559484                0              1342.0       NaN   \n",
       "2565657                0              1030.0        AT   \n",
       "2565748                0              1055.0       NaN   \n",
       "\n",
       "                         location2  year  \n",
       "3670                100 BISHOP AVE  2009  \n",
       "10272              341 OAKWOOD AVE  2009  \n",
       "24782               4001 LESLIE ST  2009  \n",
       "25612     399 LAKE SHORE BLVD WEST  2009  \n",
       "25873    3199 LAKE SHORE BLVD WEST  2009  \n",
       "26211            3030 LAWRENCE AVE  2009  \n",
       "26301            3030 LAWRENCE AVE  2009  \n",
       "27484             123 REXDALE BLVD  2009  \n",
       "32107            3030 LAWRENCE AVE  2009  \n",
       "32219            3030 LAWRENCE AVE  2009  \n",
       "33369               250 WINCOTT DR  2009  \n",
       "55319               4001 LESLIE ST  2009  \n",
       "55396               4001 LESLIE ST  2009  \n",
       "61842            90 MORNELLE COURT  2009  \n",
       "73342          1030 SHEPPARD AVE W  2009  \n",
       "73369          1030 SHEPPARD AVE W  2009  \n",
       "83731            10 HARLANDALE AVE  2009  \n",
       "87568                 150 RIVER ST  2009  \n",
       "89695              1200 MARKHAM RD  2009  \n",
       "95353               15 DENISON AVE  2009  \n",
       "103914           3030 LAWRENCE AVE  2009  \n",
       "105137          730 MT PLEASANT RD  2009  \n",
       "113322             1961 KENNEDY RD  2009  \n",
       "123151              300 BOROUGH DR  2009  \n",
       "123599             190 WOOLNER AVE  2009  \n",
       "123645           1001 ROSELAWN AVE  2009  \n",
       "131564                  MARKHAM RD  2009  \n",
       "143501           3030 LAWRENCE AVE  2009  \n",
       "145073               5801 YONGE ST  2009  \n",
       "147890            941 PROGRESS AVE  2009  \n",
       "...                            ...   ...  \n",
       "1692713           201 ELIZABETH ST  2009  \n",
       "1692901                2 CHURCH ST  2009  \n",
       "1785933          1200 MARKHAM ROAD  2009  \n",
       "1811662             1132 LESLIE ST  2009  \n",
       "1890153            375 BLEECKER ST  2009  \n",
       "1911432            375 BLEECKER ST  2009  \n",
       "1928203               7A CHURCH ST  2009  \n",
       "1946514               2265 JANE ST  2009  \n",
       "1976630            1200 MARKHAM RD  2009  \n",
       "1977028        2100 ELLESMERE ROAD  2009  \n",
       "2025959      3199 LAKESHORE BLVD W  2009  \n",
       "2145788          145 NEPTUNE DRIVE  2009  \n",
       "2157957             145 NEPTUNE DR  2009  \n",
       "2170301           3401 DUFFERIN ST  2009  \n",
       "2236055         4022 SHEPPARD AV E  2009  \n",
       "2269568               WEDLEWOOD DR  2009  \n",
       "2323330        4002 SHEPAPRD AVE E  2009  \n",
       "2323331        4002 SHEPPARD AVE E  2009  \n",
       "2351588             785 MILNER AVE  2009  \n",
       "2351733             785 MILNER AVE  2009  \n",
       "2351895             785 MILNER AVE  2009  \n",
       "2352437             785 MILNER AVE  2009  \n",
       "2353214             785 MILNER AVE  2009  \n",
       "2462668             145 NEPTUNE DR  2009  \n",
       "2469454              190 WOOLER AV  2009  \n",
       "2545535             19 WOOLNER AVE  2009  \n",
       "2545569             190 WOOLNER AV  2009  \n",
       "2559484         5117 SHEPPARD AV E  2009  \n",
       "2565657          700 LAWRENCE AV W  2009  \n",
       "2565748               85 HANNA AVE  2009  \n",
       "\n",
       "[159 rows x 8 columns]"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tpt_df[(tpt_df['infraction_code']==348) & (tpt_df['year']==2009)]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Appears that they stopped fining people for parking without a permit?? or perhaps this is a data issue??"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date_of_infraction</th>\n",
       "      <th>infraction_code</th>\n",
       "      <th>infraction_description</th>\n",
       "      <th>set_fine_amount</th>\n",
       "      <th>time_of_infraction</th>\n",
       "      <th>location1</th>\n",
       "      <th>location2</th>\n",
       "      <th>year</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>257773</th>\n",
       "      <td>20140527</td>\n",
       "      <td>130</td>\n",
       "      <td>STOP PROH TIME MUTUAL STREET</td>\n",
       "      <td>0</td>\n",
       "      <td>1153</td>\n",
       "      <td>RO</td>\n",
       "      <td>2184 EGLINTON AVE W</td>\n",
       "      <td>2014</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        date_of_infraction  infraction_code        infraction_description  \\\n",
       "257773            20140527              130  STOP PROH TIME MUTUAL STREET   \n",
       "\n",
       "        set_fine_amount  time_of_infraction location1            location2  \\\n",
       "257773                0                1153        RO  2184 EGLINTON AVE W   \n",
       "\n",
       "        year  \n",
       "257773  2014  "
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tpt_df[(tpt_df['infraction_code']==130)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date_of_infraction</th>\n",
       "      <th>infraction_code</th>\n",
       "      <th>infraction_description</th>\n",
       "      <th>set_fine_amount</th>\n",
       "      <th>time_of_infraction</th>\n",
       "      <th>location1</th>\n",
       "      <th>location2</th>\n",
       "      <th>year</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>914850</th>\n",
       "      <td>20120427</td>\n",
       "      <td>256</td>\n",
       "      <td>LEAVE OVERNIGHT WITHOUT PERMIT</td>\n",
       "      <td>0</td>\n",
       "      <td>1246</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3 MASSEY SQ</td>\n",
       "      <td>2012</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        date_of_infraction  infraction_code          infraction_description  \\\n",
       "914850            20120427              256  LEAVE OVERNIGHT WITHOUT PERMIT   \n",
       "\n",
       "        set_fine_amount  time_of_infraction location1    location2  year  \n",
       "914850                0                1246       NaN  3 MASSEY SQ  2012  "
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tpt_df[(tpt_df['infraction_code']==256)]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Looks like most of these $0 fine amt exceptions are pretty rare..."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>year</th>\n",
       "      <th>infraction_code</th>\n",
       "      <th>location2</th>\n",
       "      <th>count</th>\n",
       "      <th>fine_sum</th>\n",
       "      <th>fine_descrp</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>186723</th>\n",
       "      <td>2009</td>\n",
       "      <td>15</td>\n",
       "      <td>393 UNIVERSITY AVE</td>\n",
       "      <td>285</td>\n",
       "      <td>28500.0</td>\n",
       "      <td>PARK 3M OF FIRE HYDRANT</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        year  infraction_code           location2  count  fine_sum  \\\n",
       "186723  2009               15  393 UNIVERSITY AVE    285   28500.0   \n",
       "\n",
       "                    fine_descrp  \n",
       "186723  PARK 3M OF FIRE HYDRANT  "
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tpt_grouped_df[(tpt_grouped_df['location2']=='393 UNIVERSITY AVE') &(tpt_grouped_df['infraction_code']==15) ]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'fine_amt': 100.0, 'fine_descp': 'PARK 3M OF FIRE HYDRANT'}"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "fine_amount_dict[15]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Sweet lord this fire hydrant made $71,000 in 2012....maybe after this year they decided to paint the curb red??"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>year</th>\n",
       "      <th>infraction_code</th>\n",
       "      <th>location2</th>\n",
       "      <th>count</th>\n",
       "      <th>fine_sum</th>\n",
       "      <th>fine_descrp</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>206231</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>361 UNIVERSITY AVE</td>\n",
       "      <td>246</td>\n",
       "      <td>24600</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>592604</th>\n",
       "      <td>2009</td>\n",
       "      <td>15</td>\n",
       "      <td>361 UNIVERSITY AVE</td>\n",
       "      <td>173</td>\n",
       "      <td>17300</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>962277</th>\n",
       "      <td>2010</td>\n",
       "      <td>15</td>\n",
       "      <td>361 UNIVERSITY AVE</td>\n",
       "      <td>188</td>\n",
       "      <td>18800</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1335785</th>\n",
       "      <td>2011</td>\n",
       "      <td>15</td>\n",
       "      <td>361 UNIVERSITY AVE</td>\n",
       "      <td>296</td>\n",
       "      <td>29600</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1705949</th>\n",
       "      <td>2012</td>\n",
       "      <td>15</td>\n",
       "      <td>361 UNIVERSITY AVE</td>\n",
       "      <td>373</td>\n",
       "      <td>37300</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1984403</th>\n",
       "      <td>2013</td>\n",
       "      <td>15</td>\n",
       "      <td>361 UNIVERSITY AVE</td>\n",
       "      <td>113</td>\n",
       "      <td>11300</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2257035</th>\n",
       "      <td>2014</td>\n",
       "      <td>15</td>\n",
       "      <td>361 UNIVERSITY AVE</td>\n",
       "      <td>276</td>\n",
       "      <td>27600</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2632861</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>361 UNIVERSITY AVE</td>\n",
       "      <td>274</td>\n",
       "      <td>27400</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         year  infraction_code           location2  count  fine_sum  \\\n",
       "206231   2008               15  361 UNIVERSITY AVE    246     24600   \n",
       "592604   2009               15  361 UNIVERSITY AVE    173     17300   \n",
       "962277   2010               15  361 UNIVERSITY AVE    188     18800   \n",
       "1335785  2011               15  361 UNIVERSITY AVE    296     29600   \n",
       "1705949  2012               15  361 UNIVERSITY AVE    373     37300   \n",
       "1984403  2013               15  361 UNIVERSITY AVE    113     11300   \n",
       "2257035  2014               15  361 UNIVERSITY AVE    276     27600   \n",
       "2632861  2015               15  361 UNIVERSITY AVE    274     27400   \n",
       "\n",
       "                      fine_descrp  \n",
       "206231   PARK 3 M OF FIRE HYDRANT  \n",
       "592604   PARK 3 M OF FIRE HYDRANT  \n",
       "962277   PARK 3 M OF FIRE HYDRANT  \n",
       "1335785  PARK 3 M OF FIRE HYDRANT  \n",
       "1705949  PARK 3 M OF FIRE HYDRANT  \n",
       "1984403  PARK 3 M OF FIRE HYDRANT  \n",
       "2257035  PARK 3 M OF FIRE HYDRANT  \n",
       "2632861  PARK 3 M OF FIRE HYDRANT  "
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tpt_grouped_df[(tpt_grouped_df['location2']=='361 UNIVERSITY AVE') &(tpt_grouped_df['infraction_code']==15)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "year\n",
       "2008    111153475\n",
       "2009    105288625\n",
       "2010    109898240\n",
       "2011    114183140\n",
       "2012    111449490\n",
       "2013     42479400\n",
       "2014    108971405\n",
       "2015     99851365\n",
       "Name: set_fine_amount, dtype: int64"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tpt_df.groupby(['year'])['set_fine_amount'].sum()#.reset_index()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "year  infraction_code\n",
       "2008  1                    357090\n",
       "      2                   1967850\n",
       "      3                   9786870\n",
       "      4                    362970\n",
       "      5                  20747050\n",
       "      6                   2689110\n",
       "      7                    965500\n",
       "      8                   6781080\n",
       "      9                  10719600\n",
       "      10                   221700\n",
       "      11                     9045\n",
       "      12                     9885\n",
       "      13                     2310\n",
       "      14                   187800\n",
       "      15                  3905310\n",
       "      16                   636440\n",
       "      17                    12070\n",
       "      18                     1070\n",
       "      19                     1050\n",
       "      20                      620\n",
       "      21                     1230\n",
       "      22                       40\n",
       "      23                      740\n",
       "      24                     1890\n",
       "      25                   173460\n",
       "      26                     8250\n",
       "      28                   929340\n",
       "      29                 13580130\n",
       "      30                  1803600\n",
       "      31                   198240\n",
       "                           ...   \n",
       "2015  383                  153300\n",
       "      384                  945450\n",
       "      386                      60\n",
       "      387                    2160\n",
       "      401                   25350\n",
       "      402                   38700\n",
       "      403                11761500\n",
       "      404                   59460\n",
       "      405                   36420\n",
       "      406                 2792720\n",
       "      407                   57000\n",
       "      408                    3440\n",
       "      409                    1020\n",
       "      410                    1560\n",
       "      411                      60\n",
       "      413                      60\n",
       "      414                   64760\n",
       "      415                  377680\n",
       "      416                     360\n",
       "      417                    6360\n",
       "      418                   11960\n",
       "      419                  234780\n",
       "      420                   18420\n",
       "      423                   37080\n",
       "      425                      30\n",
       "      430                     150\n",
       "      432                      30\n",
       "      433                      30\n",
       "      434                      60\n",
       "      436                      60\n",
       "Name: set_fine_amount, dtype: int64"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tpt_df.groupby(['year','infraction_code'])['set_fine_amount'].sum()#.reset_index()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {
    "collapsed": false,
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>fine_descp</th>\n",
       "      <th>fine_amt</th>\n",
       "      <th>infraction_code</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>369</th>\n",
       "      <td>STAND STR DISABL LDG NO DROPOF</td>\n",
       "      <td>450.0</td>\n",
       "      <td>369</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>362</th>\n",
       "      <td>STAND DISABLD LDG NOT DROP OFF</td>\n",
       "      <td>450.0</td>\n",
       "      <td>362</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>355</th>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>450.0</td>\n",
       "      <td>355</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>356</th>\n",
       "      <td>STAND IN DISABLED NO PERMIT</td>\n",
       "      <td>450.0</td>\n",
       "      <td>356</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>357</th>\n",
       "      <td>PARK IN DISABLED NOT DROP OFF</td>\n",
       "      <td>450.0</td>\n",
       "      <td>357</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>358</th>\n",
       "      <td>STAND IN DISABLED NOT DROP OFF</td>\n",
       "      <td>450.0</td>\n",
       "      <td>358</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>360</th>\n",
       "      <td>STAND DISABL LOADING NO PERMIT</td>\n",
       "      <td>450.0</td>\n",
       "      <td>360</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>361</th>\n",
       "      <td>PARK DISABLD LDG NOT DROP OFF</td>\n",
       "      <td>450.0</td>\n",
       "      <td>361</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>359</th>\n",
       "      <td>PARK DISABLD LOADING NO PERMIT</td>\n",
       "      <td>450.0</td>\n",
       "      <td>359</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>367</th>\n",
       "      <td>STAND ON-ST DISABL LDG NO PRMT</td>\n",
       "      <td>450.0</td>\n",
       "      <td>367</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364</th>\n",
       "      <td>STAND ON-STRT DISABL NO PERMIT</td>\n",
       "      <td>450.0</td>\n",
       "      <td>364</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>365</th>\n",
       "      <td>STOP ON-STRT DISABLD NO PERMIT</td>\n",
       "      <td>450.0</td>\n",
       "      <td>365</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>366</th>\n",
       "      <td>PARK ON-ST DISABLD LDG NO PRMT</td>\n",
       "      <td>450.0</td>\n",
       "      <td>366</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>363</th>\n",
       "      <td>PARK ON-STRT DISABLD NO PERMIT</td>\n",
       "      <td>450.0</td>\n",
       "      <td>363</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>368</th>\n",
       "      <td>PARK STR DISABLD LDG NO DROPOF</td>\n",
       "      <td>450.0</td>\n",
       "      <td>368</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>259</th>\n",
       "      <td>STOP/PARK DIS SPACE NO PERMIT</td>\n",
       "      <td>300.0</td>\n",
       "      <td>259</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>260</th>\n",
       "      <td>STOP/PARK DIS SPACE NO PERMIT</td>\n",
       "      <td>300.0</td>\n",
       "      <td>260</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>347</th>\n",
       "      <td>PARK IN A FIRE ROUTE</td>\n",
       "      <td>250.0</td>\n",
       "      <td>347</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>220</th>\n",
       "      <td>PARK ON TRACK ON SNOW ROUTE</td>\n",
       "      <td>200.0</td>\n",
       "      <td>220</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>222</th>\n",
       "      <td>PARK-BLOCK STREETCAR-SNOW RTE</td>\n",
       "      <td>200.0</td>\n",
       "      <td>222</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>319</th>\n",
       "      <td>PARK/LEAVE BUS CONTR. TO SIGN</td>\n",
       "      <td>150.0</td>\n",
       "      <td>319</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>202</th>\n",
       "      <td>PARK HANDICAP LOADING ZONE</td>\n",
       "      <td>150.0</td>\n",
       "      <td>202</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>PARK UNAUTH VEH IN HDCPD SPACE</td>\n",
       "      <td>150.0</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>205</th>\n",
       "      <td>STOP/STAND/PARK VEND NO PERMIT</td>\n",
       "      <td>105.0</td>\n",
       "      <td>205</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>248</th>\n",
       "      <td>PARK VEHICLE WHILE NOT IN PARK</td>\n",
       "      <td>105.0</td>\n",
       "      <td>248</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>206</th>\n",
       "      <td>STOP/STAND/PARK NOT DESIG AREA</td>\n",
       "      <td>105.0</td>\n",
       "      <td>206</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>250</th>\n",
       "      <td>PARK IN PARK NOT IN DESIG AREA</td>\n",
       "      <td>105.0</td>\n",
       "      <td>250</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>257</th>\n",
       "      <td>PARK CONTRARY POSTED CONDITION</td>\n",
       "      <td>105.0</td>\n",
       "      <td>257</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>255</th>\n",
       "      <td>PARK OVERNIGHT NO PERMIT</td>\n",
       "      <td>105.0</td>\n",
       "      <td>255</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>PARK 3M OF FIRE HYDRANT</td>\n",
       "      <td>100.0</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>87</th>\n",
       "      <td>PARK MOTORCYCLE - AT ANGLE</td>\n",
       "      <td>30.0</td>\n",
       "      <td>87</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>89</th>\n",
       "      <td>PARK MOTORCYCLE - IN SPACE</td>\n",
       "      <td>30.0</td>\n",
       "      <td>89</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>PARK - ON BOULEVARD</td>\n",
       "      <td>30.0</td>\n",
       "      <td>26</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>PARK AT EXPIRED METER</td>\n",
       "      <td>30.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>STAND SIGNED TAXICAB STAND</td>\n",
       "      <td>30.0</td>\n",
       "      <td>25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>PARK TAXI-FOR HR-UNATH LOCATN</td>\n",
       "      <td>30.0</td>\n",
       "      <td>24</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>40</th>\n",
       "      <td>PARAL PRK-MTRD-FR WHLS NO OPP</td>\n",
       "      <td>20.0</td>\n",
       "      <td>40</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>115</th>\n",
       "      <td>PARK METERED SPACE PARK LOT</td>\n",
       "      <td>15.0</td>\n",
       "      <td>115</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56</th>\n",
       "      <td>FAIL TO PARK/STOP PARALLEL -LF</td>\n",
       "      <td>15.0</td>\n",
       "      <td>56</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55</th>\n",
       "      <td>FAIL TO PARK/STOP AS CLOSE AS</td>\n",
       "      <td>15.0</td>\n",
       "      <td>55</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>54</th>\n",
       "      <td>PARK/STOP OVER 30 CM FROM CURB</td>\n",
       "      <td>15.0</td>\n",
       "      <td>54</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>PARK/STOP OVER 30 CM FROM CURB</td>\n",
       "      <td>15.0</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>PARK VEHICLE - FOR SALE</td>\n",
       "      <td>15.0</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>PARK VEH WASH GREASE REPAIR</td>\n",
       "      <td>15.0</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>53</th>\n",
       "      <td>FAIL TO PARK/STOP PARALLEL TO</td>\n",
       "      <td>15.0</td>\n",
       "      <td>53</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>52</th>\n",
       "      <td>FAIL TO ANG PARK/STOP DES SPAC</td>\n",
       "      <td>15.0</td>\n",
       "      <td>52</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>51</th>\n",
       "      <td>FAIL PARK/STOP 45 DEGRESS CURB</td>\n",
       "      <td>15.0</td>\n",
       "      <td>51</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50</th>\n",
       "      <td>FAIL TO PARK/STOP NR RGHD HWY</td>\n",
       "      <td>15.0</td>\n",
       "      <td>50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49</th>\n",
       "      <td>FAIL PARK/STOP PAR RT HAND LTD</td>\n",
       "      <td>15.0</td>\n",
       "      <td>49</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>48</th>\n",
       "      <td>FAIL TO PARK/STOP PAR TO CURB</td>\n",
       "      <td>15.0</td>\n",
       "      <td>48</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>PARK-LONGER THAN 3 HOURS</td>\n",
       "      <td>15.0</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>353</th>\n",
       "      <td>PARK ON-ST DISABLD LDG NO PRMT</td>\n",
       "      <td>0.0</td>\n",
       "      <td>353</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>351</th>\n",
       "      <td>PARK DISABLD LDG NOT DROP OFF</td>\n",
       "      <td>0.0</td>\n",
       "      <td>351</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>350</th>\n",
       "      <td>PARK DISABLD LOADING NO PERMIT</td>\n",
       "      <td>0.0</td>\n",
       "      <td>350</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>349</th>\n",
       "      <td>PARK IN DISABLED NOT DROP OFF</td>\n",
       "      <td>0.0</td>\n",
       "      <td>349</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>348</th>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>0.0</td>\n",
       "      <td>348</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>258</th>\n",
       "      <td>STOP CONTRARY POSTED CONDITION</td>\n",
       "      <td>0.0</td>\n",
       "      <td>258</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>252</th>\n",
       "      <td>PARK IN PARK - PROHIBITED AREA</td>\n",
       "      <td>0.0</td>\n",
       "      <td>252</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>251</th>\n",
       "      <td>LEAVE IN PARK NOT DESIG AREA</td>\n",
       "      <td>0.0</td>\n",
       "      <td>251</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>352</th>\n",
       "      <td>PARK ON-STRT DISABLD NO PERMIT</td>\n",
       "      <td>0.0</td>\n",
       "      <td>352</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>165 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                         fine_descp  fine_amt  infraction_code\n",
       "369  STAND STR DISABL LDG NO DROPOF     450.0              369\n",
       "362  STAND DISABLD LDG NOT DROP OFF     450.0              362\n",
       "355      PARK IN DISABLED NO PERMIT     450.0              355\n",
       "356     STAND IN DISABLED NO PERMIT     450.0              356\n",
       "357   PARK IN DISABLED NOT DROP OFF     450.0              357\n",
       "358  STAND IN DISABLED NOT DROP OFF     450.0              358\n",
       "360  STAND DISABL LOADING NO PERMIT     450.0              360\n",
       "361   PARK DISABLD LDG NOT DROP OFF     450.0              361\n",
       "359  PARK DISABLD LOADING NO PERMIT     450.0              359\n",
       "367  STAND ON-ST DISABL LDG NO PRMT     450.0              367\n",
       "364  STAND ON-STRT DISABL NO PERMIT     450.0              364\n",
       "365  STOP ON-STRT DISABLD NO PERMIT     450.0              365\n",
       "366  PARK ON-ST DISABLD LDG NO PRMT     450.0              366\n",
       "363  PARK ON-STRT DISABLD NO PERMIT     450.0              363\n",
       "368  PARK STR DISABLD LDG NO DROPOF     450.0              368\n",
       "259   STOP/PARK DIS SPACE NO PERMIT     300.0              259\n",
       "260   STOP/PARK DIS SPACE NO PERMIT     300.0              260\n",
       "347            PARK IN A FIRE ROUTE     250.0              347\n",
       "220     PARK ON TRACK ON SNOW ROUTE     200.0              220\n",
       "222   PARK-BLOCK STREETCAR-SNOW RTE     200.0              222\n",
       "319   PARK/LEAVE BUS CONTR. TO SIGN     150.0              319\n",
       "202      PARK HANDICAP LOADING ZONE     150.0              202\n",
       "10   PARK UNAUTH VEH IN HDCPD SPACE     150.0               10\n",
       "205  STOP/STAND/PARK VEND NO PERMIT     105.0              205\n",
       "248  PARK VEHICLE WHILE NOT IN PARK     105.0              248\n",
       "206  STOP/STAND/PARK NOT DESIG AREA     105.0              206\n",
       "250  PARK IN PARK NOT IN DESIG AREA     105.0              250\n",
       "257  PARK CONTRARY POSTED CONDITION     105.0              257\n",
       "255        PARK OVERNIGHT NO PERMIT     105.0              255\n",
       "15          PARK 3M OF FIRE HYDRANT     100.0               15\n",
       "..                              ...       ...              ...\n",
       "87       PARK MOTORCYCLE - AT ANGLE      30.0               87\n",
       "89       PARK MOTORCYCLE - IN SPACE      30.0               89\n",
       "26              PARK - ON BOULEVARD      30.0               26\n",
       "1             PARK AT EXPIRED METER      30.0                1\n",
       "25       STAND SIGNED TAXICAB STAND      30.0               25\n",
       "24    PARK TAXI-FOR HR-UNATH LOCATN      30.0               24\n",
       "40    PARAL PRK-MTRD-FR WHLS NO OPP      20.0               40\n",
       "115     PARK METERED SPACE PARK LOT      15.0              115\n",
       "56   FAIL TO PARK/STOP PARALLEL -LF      15.0               56\n",
       "55    FAIL TO PARK/STOP AS CLOSE AS      15.0               55\n",
       "54   PARK/STOP OVER 30 CM FROM CURB      15.0               54\n",
       "11   PARK/STOP OVER 30 CM FROM CURB      15.0               11\n",
       "12          PARK VEHICLE - FOR SALE      15.0               12\n",
       "13      PARK VEH WASH GREASE REPAIR      15.0               13\n",
       "53    FAIL TO PARK/STOP PARALLEL TO      15.0               53\n",
       "52   FAIL TO ANG PARK/STOP DES SPAC      15.0               52\n",
       "51   FAIL PARK/STOP 45 DEGRESS CURB      15.0               51\n",
       "50    FAIL TO PARK/STOP NR RGHD HWY      15.0               50\n",
       "49   FAIL PARK/STOP PAR RT HAND LTD      15.0               49\n",
       "48    FAIL TO PARK/STOP PAR TO CURB      15.0               48\n",
       "2          PARK-LONGER THAN 3 HOURS      15.0                2\n",
       "353  PARK ON-ST DISABLD LDG NO PRMT       0.0              353\n",
       "351   PARK DISABLD LDG NOT DROP OFF       0.0              351\n",
       "350  PARK DISABLD LOADING NO PERMIT       0.0              350\n",
       "349   PARK IN DISABLED NOT DROP OFF       0.0              349\n",
       "348      PARK IN DISABLED NO PERMIT       0.0              348\n",
       "258  STOP CONTRARY POSTED CONDITION       0.0              258\n",
       "252  PARK IN PARK - PROHIBITED AREA       0.0              252\n",
       "251    LEAVE IN PARK NOT DESIG AREA       0.0              251\n",
       "352  PARK ON-STRT DISABLD NO PERMIT       0.0              352\n",
       "\n",
       "[165 rows x 3 columns]"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "fine_amt_df=pd.DataFrame.from_dict(fine_amount_dict,orient='index')\n",
    "\n",
    "fine_amt_df['infraction_code']=fine_amt_df.index #index is infraction code\n",
    "\n",
    "fine_amt_df.sort_values(by='fine_amt',ascending=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>year</th>\n",
       "      <th>infraction_code</th>\n",
       "      <th>location2</th>\n",
       "      <th>count</th>\n",
       "      <th>fine_sum</th>\n",
       "      <th>fine_descrp</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "Empty DataFrame\n",
       "Columns: [year, infraction_code, location2, count, fine_sum, fine_descrp]\n",
       "Index: []"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tpt_grouped_df[(tpt_grouped_df['infraction_code']==15) & (tpt_grouped_df['year']==2012)] \\\n",
    "        .sort_values('fine_sum',ascending=False).head(n=10)\n",
    "\n",
    "# tpt_grouped_df[tpt_grouped_df['year']==2012] \\\n",
    "#         .sort_values('fine_sum',ascending=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "mean_time_df=tpt_df.groupby(['year','infraction_code','location2'])['time_of_infraction'].mean().reset_index()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(367838, 4)\n",
      "(367838, 6)\n",
      "(367838, 7)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>year</th>\n",
       "      <th>infraction_code</th>\n",
       "      <th>location2</th>\n",
       "      <th>count</th>\n",
       "      <th>fine_sum</th>\n",
       "      <th>fine_descrp</th>\n",
       "      <th>time_of_infraction</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2009</td>\n",
       "      <td>1</td>\n",
       "      <td>1 ALBERTUS AVE</td>\n",
       "      <td>2</td>\n",
       "      <td>60.0</td>\n",
       "      <td>PARK AT EXPIRED METER</td>\n",
       "      <td>1239.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2009</td>\n",
       "      <td>1</td>\n",
       "      <td>1 BANGOR RD</td>\n",
       "      <td>1</td>\n",
       "      <td>30.0</td>\n",
       "      <td>PARK AT EXPIRED METER</td>\n",
       "      <td>1718.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2009</td>\n",
       "      <td>1</td>\n",
       "      <td>1 BEDFORD PARK AVE</td>\n",
       "      <td>1</td>\n",
       "      <td>30.0</td>\n",
       "      <td>PARK AT EXPIRED METER</td>\n",
       "      <td>1933.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2009</td>\n",
       "      <td>1</td>\n",
       "      <td>1 BRUNSWICK AVE</td>\n",
       "      <td>13</td>\n",
       "      <td>390.0</td>\n",
       "      <td>PARK AT EXPIRED METER</td>\n",
       "      <td>1348.230769</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2009</td>\n",
       "      <td>1</td>\n",
       "      <td>1 CHARLESWOOD DR</td>\n",
       "      <td>3</td>\n",
       "      <td>90.0</td>\n",
       "      <td>PARK AT EXPIRED METER</td>\n",
       "      <td>1365.333333</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   year  infraction_code           location2  count  fine_sum  \\\n",
       "0  2009                1      1 ALBERTUS AVE      2      60.0   \n",
       "1  2009                1         1 BANGOR RD      1      30.0   \n",
       "2  2009                1  1 BEDFORD PARK AVE      1      30.0   \n",
       "3  2009                1     1 BRUNSWICK AVE     13     390.0   \n",
       "4  2009                1    1 CHARLESWOOD DR      3      90.0   \n",
       "\n",
       "             fine_descrp  time_of_infraction  \n",
       "0  PARK AT EXPIRED METER         1239.500000  \n",
       "1  PARK AT EXPIRED METER         1718.000000  \n",
       "2  PARK AT EXPIRED METER         1933.000000  \n",
       "3  PARK AT EXPIRED METER         1348.230769  \n",
       "4  PARK AT EXPIRED METER         1365.333333  "
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "print (mean_time_df.shape)\n",
    "print (tpt_grouped_df.shape)\n",
    "tpt_merged_df=pd.merge(tpt_grouped_df, mean_time_df, on=['year','infraction_code','location2'], how='inner')\n",
    "print (tpt_merged_df.shape)\n",
    "tpt_merged_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>year</th>\n",
       "      <th>infraction_code</th>\n",
       "      <th>street_address</th>\n",
       "      <th>count</th>\n",
       "      <th>fine_sum</th>\n",
       "      <th>fine_descrp</th>\n",
       "      <th>mean_time_of_infraction</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2008</td>\n",
       "      <td>1</td>\n",
       "      <td>1  FOUR WINDS DR</td>\n",
       "      <td>1</td>\n",
       "      <td>30</td>\n",
       "      <td>PARK FAIL TO DEPOSIT FEE METER</td>\n",
       "      <td>1033.000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2008</td>\n",
       "      <td>1</td>\n",
       "      <td>1 9 MOBERLY AVE</td>\n",
       "      <td>1</td>\n",
       "      <td>30</td>\n",
       "      <td>PARK FAIL TO DEPOSIT FEE METER</td>\n",
       "      <td>1106.000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2008</td>\n",
       "      <td>1</td>\n",
       "      <td>1 BANGOR RD</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>PARK FAIL TO DEPOSIT FEE METER</td>\n",
       "      <td>1640.000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2008</td>\n",
       "      <td>1</td>\n",
       "      <td>1 BEAMAN RD</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>PARK FAIL TO DEPOSIT FEE METER</td>\n",
       "      <td>1291.000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2008</td>\n",
       "      <td>1</td>\n",
       "      <td>1 BEDFORD PARK AVE</td>\n",
       "      <td>8</td>\n",
       "      <td>240</td>\n",
       "      <td>PARK FAIL TO DEPOSIT FEE METER</td>\n",
       "      <td>1428.625</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   year  infraction_code      street_address  count  fine_sum  \\\n",
       "0  2008                1    1  FOUR WINDS DR      1        30   \n",
       "1  2008                1     1 9 MOBERLY AVE      1        30   \n",
       "2  2008                1         1 BANGOR RD      2        60   \n",
       "3  2008                1         1 BEAMAN RD      2        60   \n",
       "4  2008                1  1 BEDFORD PARK AVE      8       240   \n",
       "\n",
       "                      fine_descrp  mean_time_of_infraction  \n",
       "0  PARK FAIL TO DEPOSIT FEE METER                 1033.000  \n",
       "1  PARK FAIL TO DEPOSIT FEE METER                 1106.000  \n",
       "2  PARK FAIL TO DEPOSIT FEE METER                 1640.000  \n",
       "3  PARK FAIL TO DEPOSIT FEE METER                 1291.000  \n",
       "4  PARK FAIL TO DEPOSIT FEE METER                 1428.625  "
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tpt_merged_df=tpt_merged_df.rename(index=str, columns={\"time_of_infraction\": \"mean_time_of_infraction\" \\\n",
    "                                                               ,\"location2\":\"street_address\"})\n",
    "tpt_merged_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {
    "collapsed": false,
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>year</th>\n",
       "      <th>infraction_code</th>\n",
       "      <th>street_address</th>\n",
       "      <th>count</th>\n",
       "      <th>fine_sum</th>\n",
       "      <th>fine_descrp</th>\n",
       "      <th>mean_hour</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>206968</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>43 ELM ST</td>\n",
       "      <td>869</td>\n",
       "      <td>86900</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>207724</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>5100 YONGE ST</td>\n",
       "      <td>496</td>\n",
       "      <td>49600</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>206509</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>393 UNIVERSITY AVE</td>\n",
       "      <td>465</td>\n",
       "      <td>46500</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>205795</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>33 ELMHURST AVE</td>\n",
       "      <td>397</td>\n",
       "      <td>39700</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>208114</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>56 THE ESPLANADE</td>\n",
       "      <td>384</td>\n",
       "      <td>38400</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>206668</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>40 ORCHARD VIEW BLVD</td>\n",
       "      <td>327</td>\n",
       "      <td>32700</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>201055</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>112 MERTON ST</td>\n",
       "      <td>300</td>\n",
       "      <td>30000</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>207742</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>5150 YONGE ST</td>\n",
       "      <td>299</td>\n",
       "      <td>29900</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>208370</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>6 SPRING GARDEN AVE</td>\n",
       "      <td>262</td>\n",
       "      <td>26200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>204778</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>26 WELLINGTON ST E</td>\n",
       "      <td>248</td>\n",
       "      <td>24800</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>206231</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>361 UNIVERSITY AVE</td>\n",
       "      <td>246</td>\n",
       "      <td>24600</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>208042</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>5519 YONGE ST</td>\n",
       "      <td>193</td>\n",
       "      <td>19300</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>203011</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>184 SPADINA AVE</td>\n",
       "      <td>174</td>\n",
       "      <td>17400</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>210614</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>VILLIERS ST</td>\n",
       "      <td>168</td>\n",
       "      <td>16800</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>205513</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>31 ELM ST</td>\n",
       "      <td>158</td>\n",
       "      <td>15800</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>210145</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>98 THE ESPLANADE</td>\n",
       "      <td>155</td>\n",
       "      <td>15500</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>202495</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>160 MUTUAL ST</td>\n",
       "      <td>150</td>\n",
       "      <td>15000</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>204407</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>2409 YONGE ST</td>\n",
       "      <td>147</td>\n",
       "      <td>14700</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>209853</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>9 CHURCH ST</td>\n",
       "      <td>144</td>\n",
       "      <td>14400</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>206855</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>417 SPADINA RD</td>\n",
       "      <td>144</td>\n",
       "      <td>14400</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>205612</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>318 QUEEN ST W</td>\n",
       "      <td>142</td>\n",
       "      <td>14200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>207761</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>518 PALMERSTON BLVD</td>\n",
       "      <td>140</td>\n",
       "      <td>14000</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>210237</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>BOROUGH DR</td>\n",
       "      <td>138</td>\n",
       "      <td>13800</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>202737</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>171 KING ST E</td>\n",
       "      <td>136</td>\n",
       "      <td>13600</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>205360</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>30 GLENDALE AVE</td>\n",
       "      <td>133</td>\n",
       "      <td>13300</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>206212</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>36 WELLINGTON ST E</td>\n",
       "      <td>132</td>\n",
       "      <td>13200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>204505</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>25 BELLEVUE AVE</td>\n",
       "      <td>130</td>\n",
       "      <td>13000</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>204109</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>227 VICTORIA ST</td>\n",
       "      <td>127</td>\n",
       "      <td>12700</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>201440</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>123 SUNNYSIDE AVE</td>\n",
       "      <td>125</td>\n",
       "      <td>12500</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>207670</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>5050 YONGE ST</td>\n",
       "      <td>125</td>\n",
       "      <td>12500</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2628348</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>1 SCOTT ST</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2634934</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>68 NORTHCOTE AVE</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2636079</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>EAST LIBERTY ST</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2633025</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>386 RONCESVALLES AVE</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2628617</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>106 WALTON ST</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2634971</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>69 LAING ST</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2629463</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>14 SAYWELL AVE</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2631291</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>238 BERKELEY ST</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2634819</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>650 PARLIAMENT ST</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2634374</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>56 TEMPERANCE ST</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2630893</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>2120 QUEEN ST E</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2629922</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>160 DAN LECKIE WAY</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2633700</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>47 DAVIES AVE</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2634222</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>540 SPADINA CRES</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2632002</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>29 NIAGARA ST</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2630843</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>21 MELINDA ST</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2635330</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>79 WINCHESTER ST</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2634391</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>561 QUEEN ST W</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2634866</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>660 CRAWFORD ST</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2632629</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>3397 YONGE ST</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2635798</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>94 EVELYN WIGGINS DR</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2636364</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>ST JOSEPH ST</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2634638</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>601 KINGSTON RD</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2634554</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>6 ANNDALE DR</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>17</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2629566</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>145 MUNRO ST</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2631968</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>287 ASSINIBOINE RD</td>\n",
       "      <td>11</td>\n",
       "      <td>1100</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2632891</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>368 ROXTON RD</td>\n",
       "      <td>11</td>\n",
       "      <td>1100</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2629682</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>15 ST MARY ST</td>\n",
       "      <td>11</td>\n",
       "      <td>1100</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2634250</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>5453a YONGE ST</td>\n",
       "      <td>11</td>\n",
       "      <td>1100</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2636384</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>TECUMSETH ST</td>\n",
       "      <td>11</td>\n",
       "      <td>1100</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>4000 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         year  infraction_code        street_address  count  fine_sum  \\\n",
       "206968   2008               15             43 ELM ST    869     86900   \n",
       "207724   2008               15         5100 YONGE ST    496     49600   \n",
       "206509   2008               15    393 UNIVERSITY AVE    465     46500   \n",
       "205795   2008               15       33 ELMHURST AVE    397     39700   \n",
       "208114   2008               15      56 THE ESPLANADE    384     38400   \n",
       "206668   2008               15  40 ORCHARD VIEW BLVD    327     32700   \n",
       "201055   2008               15         112 MERTON ST    300     30000   \n",
       "207742   2008               15         5150 YONGE ST    299     29900   \n",
       "208370   2008               15   6 SPRING GARDEN AVE    262     26200   \n",
       "204778   2008               15    26 WELLINGTON ST E    248     24800   \n",
       "206231   2008               15    361 UNIVERSITY AVE    246     24600   \n",
       "208042   2008               15         5519 YONGE ST    193     19300   \n",
       "203011   2008               15       184 SPADINA AVE    174     17400   \n",
       "210614   2008               15           VILLIERS ST    168     16800   \n",
       "205513   2008               15             31 ELM ST    158     15800   \n",
       "210145   2008               15      98 THE ESPLANADE    155     15500   \n",
       "202495   2008               15         160 MUTUAL ST    150     15000   \n",
       "204407   2008               15         2409 YONGE ST    147     14700   \n",
       "209853   2008               15           9 CHURCH ST    144     14400   \n",
       "206855   2008               15        417 SPADINA RD    144     14400   \n",
       "205612   2008               15        318 QUEEN ST W    142     14200   \n",
       "207761   2008               15   518 PALMERSTON BLVD    140     14000   \n",
       "210237   2008               15            BOROUGH DR    138     13800   \n",
       "202737   2008               15         171 KING ST E    136     13600   \n",
       "205360   2008               15       30 GLENDALE AVE    133     13300   \n",
       "206212   2008               15    36 WELLINGTON ST E    132     13200   \n",
       "204505   2008               15       25 BELLEVUE AVE    130     13000   \n",
       "204109   2008               15       227 VICTORIA ST    127     12700   \n",
       "201440   2008               15     123 SUNNYSIDE AVE    125     12500   \n",
       "207670   2008               15         5050 YONGE ST    125     12500   \n",
       "...       ...              ...                   ...    ...       ...   \n",
       "2628348  2015               15            1 SCOTT ST     12      1200   \n",
       "2634934  2015               15      68 NORTHCOTE AVE     12      1200   \n",
       "2636079  2015               15       EAST LIBERTY ST     12      1200   \n",
       "2633025  2015               15  386 RONCESVALLES AVE     12      1200   \n",
       "2628617  2015               15         106 WALTON ST     12      1200   \n",
       "2634971  2015               15           69 LAING ST     12      1200   \n",
       "2629463  2015               15        14 SAYWELL AVE     12      1200   \n",
       "2631291  2015               15       238 BERKELEY ST     12      1200   \n",
       "2634819  2015               15     650 PARLIAMENT ST     12      1200   \n",
       "2634374  2015               15      56 TEMPERANCE ST     12      1200   \n",
       "2630893  2015               15       2120 QUEEN ST E     12      1200   \n",
       "2629922  2015               15    160 DAN LECKIE WAY     12      1200   \n",
       "2633700  2015               15         47 DAVIES AVE     12      1200   \n",
       "2634222  2015               15      540 SPADINA CRES     12      1200   \n",
       "2632002  2015               15         29 NIAGARA ST     12      1200   \n",
       "2630843  2015               15         21 MELINDA ST     12      1200   \n",
       "2635330  2015               15      79 WINCHESTER ST     12      1200   \n",
       "2634391  2015               15        561 QUEEN ST W     12      1200   \n",
       "2634866  2015               15       660 CRAWFORD ST     12      1200   \n",
       "2632629  2015               15         3397 YONGE ST     12      1200   \n",
       "2635798  2015               15  94 EVELYN WIGGINS DR     12      1200   \n",
       "2636364  2015               15          ST JOSEPH ST     12      1200   \n",
       "2634638  2015               15       601 KINGSTON RD     12      1200   \n",
       "2634554  2015               15          6 ANNDALE DR     12      1200   \n",
       "2629566  2015               15          145 MUNRO ST     12      1200   \n",
       "2631968  2015               15    287 ASSINIBOINE RD     11      1100   \n",
       "2632891  2015               15         368 ROXTON RD     11      1100   \n",
       "2629682  2015               15         15 ST MARY ST     11      1100   \n",
       "2634250  2015               15        5453a YONGE ST     11      1100   \n",
       "2636384  2015               15          TECUMSETH ST     11      1100   \n",
       "\n",
       "                      fine_descrp  mean_hour  \n",
       "206968   PARK 3 M OF FIRE HYDRANT         15  \n",
       "207724   PARK 3 M OF FIRE HYDRANT         14  \n",
       "206509   PARK 3 M OF FIRE HYDRANT         12  \n",
       "205795   PARK 3 M OF FIRE HYDRANT         13  \n",
       "208114   PARK 3 M OF FIRE HYDRANT         16  \n",
       "206668   PARK 3 M OF FIRE HYDRANT         15  \n",
       "201055   PARK 3 M OF FIRE HYDRANT         13  \n",
       "207742   PARK 3 M OF FIRE HYDRANT         14  \n",
       "208370   PARK 3 M OF FIRE HYDRANT         16  \n",
       "204778   PARK 3 M OF FIRE HYDRANT         14  \n",
       "206231   PARK 3 M OF FIRE HYDRANT         12  \n",
       "208042   PARK 3 M OF FIRE HYDRANT         14  \n",
       "203011   PARK 3 M OF FIRE HYDRANT         15  \n",
       "210614   PARK 3 M OF FIRE HYDRANT         12  \n",
       "205513   PARK 3 M OF FIRE HYDRANT         16  \n",
       "210145   PARK 3 M OF FIRE HYDRANT         15  \n",
       "202495   PARK 3 M OF FIRE HYDRANT         15  \n",
       "204407   PARK 3 M OF FIRE HYDRANT         14  \n",
       "209853   PARK 3 M OF FIRE HYDRANT         15  \n",
       "206855   PARK 3 M OF FIRE HYDRANT         12  \n",
       "205612   PARK 3 M OF FIRE HYDRANT         15  \n",
       "207761   PARK 3 M OF FIRE HYDRANT         15  \n",
       "210237   PARK 3 M OF FIRE HYDRANT         10  \n",
       "202737   PARK 3 M OF FIRE HYDRANT         14  \n",
       "205360   PARK 3 M OF FIRE HYDRANT         14  \n",
       "206212   PARK 3 M OF FIRE HYDRANT         15  \n",
       "204505   PARK 3 M OF FIRE HYDRANT         13  \n",
       "204109   PARK 3 M OF FIRE HYDRANT         15  \n",
       "201440   PARK 3 M OF FIRE HYDRANT         14  \n",
       "207670   PARK 3 M OF FIRE HYDRANT         14  \n",
       "...                           ...        ...  \n",
       "2628348  PARK 3 M OF FIRE HYDRANT         13  \n",
       "2634934  PARK 3 M OF FIRE HYDRANT          8  \n",
       "2636079  PARK 3 M OF FIRE HYDRANT         16  \n",
       "2633025  PARK 3 M OF FIRE HYDRANT         14  \n",
       "2628617  PARK 3 M OF FIRE HYDRANT         13  \n",
       "2634971  PARK 3 M OF FIRE HYDRANT         14  \n",
       "2629463  PARK 3 M OF FIRE HYDRANT         14  \n",
       "2631291  PARK 3 M OF FIRE HYDRANT         12  \n",
       "2634819  PARK 3 M OF FIRE HYDRANT         11  \n",
       "2634374  PARK 3 M OF FIRE HYDRANT         13  \n",
       "2630893  PARK 3 M OF FIRE HYDRANT         16  \n",
       "2629922  PARK 3 M OF FIRE HYDRANT         11  \n",
       "2633700  PARK 3 M OF FIRE HYDRANT         15  \n",
       "2634222  PARK 3 M OF FIRE HYDRANT          8  \n",
       "2632002  PARK 3 M OF FIRE HYDRANT         14  \n",
       "2630843  PARK 3 M OF FIRE HYDRANT         13  \n",
       "2635330  PARK 3 M OF FIRE HYDRANT         14  \n",
       "2634391  PARK 3 M OF FIRE HYDRANT         13  \n",
       "2634866  PARK 3 M OF FIRE HYDRANT         13  \n",
       "2632629  PARK 3 M OF FIRE HYDRANT         14  \n",
       "2635798  PARK 3 M OF FIRE HYDRANT         15  \n",
       "2636364  PARK 3 M OF FIRE HYDRANT         15  \n",
       "2634638  PARK 3 M OF FIRE HYDRANT         14  \n",
       "2634554  PARK 3 M OF FIRE HYDRANT         17  \n",
       "2629566  PARK 3 M OF FIRE HYDRANT         13  \n",
       "2631968  PARK 3 M OF FIRE HYDRANT         16  \n",
       "2632891  PARK 3 M OF FIRE HYDRANT         13  \n",
       "2629682  PARK 3 M OF FIRE HYDRANT         13  \n",
       "2634250  PARK 3 M OF FIRE HYDRANT         14  \n",
       "2636384  PARK 3 M OF FIRE HYDRANT         14  \n",
       "\n",
       "[4000 rows x 7 columns]"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "##create a DF with the top 500 grossing fire hydrants each year...\n",
    "\n",
    "final_df=None\n",
    "df_list=[]\n",
    "for year in range(2008,2016):\n",
    "    df_list.append(tpt_merged_df[(tpt_merged_df['infraction_code']==15) & (tpt_merged_df['year']==year)] \\\n",
    "            .sort_values('fine_sum',ascending=False).head(n=500))\n",
    "\n",
    "final_df= pd.concat(df_list, axis=0)\n",
    "\n",
    "\n",
    "##time formatting is weird; 5 --> 12:05am, 30 --> 12:30am, 15:20 --> 3:20pm etc.\n",
    "def round_time(df):\n",
    "    time_str=str(df['mean_time_of_infraction'])\n",
    "    time_len=len(time_str.split('.')[0])\n",
    "    if time_len==1:\n",
    "        rnded_time=0\n",
    "    elif time_len==2:\n",
    "        if float(time_str)<30:\n",
    "            rnded_time=0\n",
    "        else:\n",
    "            rnded_time=1\n",
    "    elif time_len==3:\n",
    "        rnded_time=round(float(time_str[0:1]+'.'+time_str[1:3]),0)\n",
    "    elif time_len==4:\n",
    "        rnded_time=round(float(time_str[0:2]+'.'+time_str[2:4]),0)\n",
    "    else:\n",
    "        rnded_time=0\n",
    "    return rnded_time\n",
    "\n",
    "\n",
    "final_df['mean_hour']=final_df.apply(round_time,axis=1)\n",
    "final_df=final_df.drop(['mean_time_of_infraction'],axis=1)\n",
    "\n",
    "final_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1266"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "locations_1=final_df['street_address'].unique()\n",
    "len(locations_1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {
    "collapsed": false,
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>year</th>\n",
       "      <th>infraction_code</th>\n",
       "      <th>street_address</th>\n",
       "      <th>count</th>\n",
       "      <th>fine_sum</th>\n",
       "      <th>fine_descrp</th>\n",
       "      <th>mean_hour</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>53976</th>\n",
       "      <td>2008</td>\n",
       "      <td>3</td>\n",
       "      <td>25 THE WEST MALL</td>\n",
       "      <td>8291</td>\n",
       "      <td>248730</td>\n",
       "      <td>PARK/LEAVE ON PRIVATE PROPERTY</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50294</th>\n",
       "      <td>2008</td>\n",
       "      <td>3</td>\n",
       "      <td>1750 FINCH AVE E</td>\n",
       "      <td>7525</td>\n",
       "      <td>225750</td>\n",
       "      <td>PARK/LEAVE ON PRIVATE PROPERTY</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>90392</th>\n",
       "      <td>2008</td>\n",
       "      <td>5</td>\n",
       "      <td>20 EDWARD ST</td>\n",
       "      <td>4328</td>\n",
       "      <td>173120</td>\n",
       "      <td>PARK HWY PROHIBED TIME/DAY</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>52076</th>\n",
       "      <td>2008</td>\n",
       "      <td>3</td>\n",
       "      <td>2075 BAYVIEW AVE</td>\n",
       "      <td>5394</td>\n",
       "      <td>161820</td>\n",
       "      <td>PARK/LEAVE ON PRIVATE PROPERTY</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>189893</th>\n",
       "      <td>2008</td>\n",
       "      <td>9</td>\n",
       "      <td>60 MURRAY ST</td>\n",
       "      <td>2683</td>\n",
       "      <td>160980</td>\n",
       "      <td>STOP HWY PROHIBITED TIME/DAY</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>401943</th>\n",
       "      <td>2008</td>\n",
       "      <td>347</td>\n",
       "      <td>45 OVERLEA BLVD</td>\n",
       "      <td>479</td>\n",
       "      <td>119750</td>\n",
       "      <td>PARK IN A FIRE ROUTE</td>\n",
       "      <td>17</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>52075</th>\n",
       "      <td>2008</td>\n",
       "      <td>3</td>\n",
       "      <td>2075 BAYVIEW AV</td>\n",
       "      <td>3916</td>\n",
       "      <td>117480</td>\n",
       "      <td>PARK/LEAVE ON PRIVATE PROPERTY</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>169512</th>\n",
       "      <td>2008</td>\n",
       "      <td>8</td>\n",
       "      <td>244 VICTORIA ST</td>\n",
       "      <td>1820</td>\n",
       "      <td>109200</td>\n",
       "      <td>STAND SIGN HWY PRO TIMES/DAYS</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>96905</th>\n",
       "      <td>2008</td>\n",
       "      <td>5</td>\n",
       "      <td>2401 YONGE ST</td>\n",
       "      <td>2552</td>\n",
       "      <td>102080</td>\n",
       "      <td>PARK HWY PROHIBED TIME/DAY</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>194386</th>\n",
       "      <td>2008</td>\n",
       "      <td>9</td>\n",
       "      <td>JAMES ST</td>\n",
       "      <td>1664</td>\n",
       "      <td>99840</td>\n",
       "      <td>STOP HWY PROHIBITED TIME/DAY</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>181384</th>\n",
       "      <td>2008</td>\n",
       "      <td>9</td>\n",
       "      <td>200 ELIZABETH ST</td>\n",
       "      <td>1542</td>\n",
       "      <td>92520</td>\n",
       "      <td>STOP HWY PROHIBITED TIME/DAY</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>190618</th>\n",
       "      <td>2008</td>\n",
       "      <td>9</td>\n",
       "      <td>66 WELLINGTON ST W</td>\n",
       "      <td>1510</td>\n",
       "      <td>90600</td>\n",
       "      <td>STOP HWY PROHIBITED TIME/DAY</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>401342</th>\n",
       "      <td>2008</td>\n",
       "      <td>347</td>\n",
       "      <td>31 TAPSCOTT RD</td>\n",
       "      <td>361</td>\n",
       "      <td>90250</td>\n",
       "      <td>PARK IN A FIRE ROUTE</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>401487</th>\n",
       "      <td>2008</td>\n",
       "      <td>347</td>\n",
       "      <td>3401 DUFFERIN ST</td>\n",
       "      <td>355</td>\n",
       "      <td>88750</td>\n",
       "      <td>PARK IN A FIRE ROUTE</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>401252</th>\n",
       "      <td>2008</td>\n",
       "      <td>347</td>\n",
       "      <td>300 BOROUGH DR</td>\n",
       "      <td>351</td>\n",
       "      <td>87750</td>\n",
       "      <td>PARK IN A FIRE ROUTE</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>402185</th>\n",
       "      <td>2008</td>\n",
       "      <td>347</td>\n",
       "      <td>5100 YONGE ST</td>\n",
       "      <td>349</td>\n",
       "      <td>87250</td>\n",
       "      <td>PARK IN A FIRE ROUTE</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>206968</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>43 ELM ST</td>\n",
       "      <td>869</td>\n",
       "      <td>86900</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>402836</th>\n",
       "      <td>2008</td>\n",
       "      <td>347</td>\n",
       "      <td>85 ELLESMERE RD</td>\n",
       "      <td>346</td>\n",
       "      <td>86500</td>\n",
       "      <td>PARK IN A FIRE ROUTE</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>400314</th>\n",
       "      <td>2008</td>\n",
       "      <td>347</td>\n",
       "      <td>1921 EGLINTON AVE E</td>\n",
       "      <td>335</td>\n",
       "      <td>83750</td>\n",
       "      <td>PARK IN A FIRE ROUTE</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>168739</th>\n",
       "      <td>2008</td>\n",
       "      <td>8</td>\n",
       "      <td>200 KING ST E</td>\n",
       "      <td>1344</td>\n",
       "      <td>80640</td>\n",
       "      <td>STAND SIGN HWY PRO TIMES/DAYS</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>167484</th>\n",
       "      <td>2008</td>\n",
       "      <td>8</td>\n",
       "      <td>15 ASQUITH AVE</td>\n",
       "      <td>1280</td>\n",
       "      <td>76800</td>\n",
       "      <td>STAND SIGN HWY PRO TIMES/DAYS</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>133887</th>\n",
       "      <td>2008</td>\n",
       "      <td>5</td>\n",
       "      <td>74 VICTORIA ST</td>\n",
       "      <td>1896</td>\n",
       "      <td>75840</td>\n",
       "      <td>PARK HWY PROHIBED TIME/DAY</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>81905</th>\n",
       "      <td>2008</td>\n",
       "      <td>5</td>\n",
       "      <td>158 VICTORIA ST</td>\n",
       "      <td>1867</td>\n",
       "      <td>74680</td>\n",
       "      <td>PARK HWY PROHIBED TIME/DAY</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>400851</th>\n",
       "      <td>2008</td>\n",
       "      <td>347</td>\n",
       "      <td>25 THE WEST MALL</td>\n",
       "      <td>298</td>\n",
       "      <td>74500</td>\n",
       "      <td>PARK IN A FIRE ROUTE</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>171430</th>\n",
       "      <td>2008</td>\n",
       "      <td>8</td>\n",
       "      <td>40 ORCHARD VIEW BLVD</td>\n",
       "      <td>1208</td>\n",
       "      <td>72480</td>\n",
       "      <td>STAND SIGN HWY PRO TIMES/DAYS</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>47976</th>\n",
       "      <td>2008</td>\n",
       "      <td>3</td>\n",
       "      <td>1265 MILITARY TR</td>\n",
       "      <td>2409</td>\n",
       "      <td>72270</td>\n",
       "      <td>PARK/LEAVE ON PRIVATE PROPERTY</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>168680</th>\n",
       "      <td>2008</td>\n",
       "      <td>8</td>\n",
       "      <td>20 EGLINTON AVE W</td>\n",
       "      <td>1200</td>\n",
       "      <td>72000</td>\n",
       "      <td>STAND SIGN HWY PRO TIMES/DAYS</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381887</th>\n",
       "      <td>2008</td>\n",
       "      <td>250</td>\n",
       "      <td>1675 LAKE SHORE BLVD E</td>\n",
       "      <td>679</td>\n",
       "      <td>71295</td>\n",
       "      <td>PARK IN PARK NOT IN DESIG AREA</td>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>173489</th>\n",
       "      <td>2008</td>\n",
       "      <td>8</td>\n",
       "      <td>78 HOLLY ST</td>\n",
       "      <td>1167</td>\n",
       "      <td>70020</td>\n",
       "      <td>STAND SIGN HWY PRO TIMES/DAYS</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>402043</th>\n",
       "      <td>2008</td>\n",
       "      <td>347</td>\n",
       "      <td>4968 YONGE ST</td>\n",
       "      <td>276</td>\n",
       "      <td>69000</td>\n",
       "      <td>PARK IN A FIRE ROUTE</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2791960</th>\n",
       "      <td>2015</td>\n",
       "      <td>403</td>\n",
       "      <td>21 BALMUTO ST</td>\n",
       "      <td>106</td>\n",
       "      <td>15900</td>\n",
       "      <td>STOP-SIGNED HIGHWAY-RUSH HOUR</td>\n",
       "      <td>17</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2795889</th>\n",
       "      <td>2015</td>\n",
       "      <td>403</td>\n",
       "      <td>5100 YONGE ST</td>\n",
       "      <td>106</td>\n",
       "      <td>15900</td>\n",
       "      <td>STOP-SIGNED HIGHWAY-RUSH HOUR</td>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2577273</th>\n",
       "      <td>2015</td>\n",
       "      <td>5</td>\n",
       "      <td>51 WINCHESTER ST</td>\n",
       "      <td>396</td>\n",
       "      <td>15840</td>\n",
       "      <td>PARK HWY PROHIBED TIME/DAY</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2616499</th>\n",
       "      <td>2015</td>\n",
       "      <td>9</td>\n",
       "      <td>11 NELSON ST</td>\n",
       "      <td>264</td>\n",
       "      <td>15840</td>\n",
       "      <td>STOP HWY PROHIBITED TIME/DAY</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2500210</th>\n",
       "      <td>2015</td>\n",
       "      <td>2</td>\n",
       "      <td>34 LITTLE NORWAY CRES</td>\n",
       "      <td>1055</td>\n",
       "      <td>15825</td>\n",
       "      <td>PARK LONGER THAN 3 HOURS</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2782733</th>\n",
       "      <td>2015</td>\n",
       "      <td>355</td>\n",
       "      <td>15 PROVOST DR</td>\n",
       "      <td>35</td>\n",
       "      <td>15750</td>\n",
       "      <td>PARK IN DISABLED NO PERMIT</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2782069</th>\n",
       "      <td>2015</td>\n",
       "      <td>347</td>\n",
       "      <td>6464 YONGE ST</td>\n",
       "      <td>63</td>\n",
       "      <td>15750</td>\n",
       "      <td>PARK IN A FIRE ROUTE</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2620104</th>\n",
       "      <td>2015</td>\n",
       "      <td>9</td>\n",
       "      <td>3 PARK HOME AVE</td>\n",
       "      <td>262</td>\n",
       "      <td>15720</td>\n",
       "      <td>STOP HWY PROHIBITED TIME/DAY</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2617692</th>\n",
       "      <td>2015</td>\n",
       "      <td>9</td>\n",
       "      <td>150 ELIZABETH ST</td>\n",
       "      <td>262</td>\n",
       "      <td>15720</td>\n",
       "      <td>STOP HWY PROHIBITED TIME/DAY</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2585237</th>\n",
       "      <td>2015</td>\n",
       "      <td>5</td>\n",
       "      <td>70 CHESTNUT PK</td>\n",
       "      <td>392</td>\n",
       "      <td>15680</td>\n",
       "      <td>PARK HWY PROHIBED TIME/DAY</td>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2593640</th>\n",
       "      <td>2015</td>\n",
       "      <td>5</td>\n",
       "      <td>COXWELL AVE</td>\n",
       "      <td>391</td>\n",
       "      <td>15640</td>\n",
       "      <td>PARK HWY PROHIBED TIME/DAY</td>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2557065</th>\n",
       "      <td>2015</td>\n",
       "      <td>5</td>\n",
       "      <td>23 VICTORIA ST</td>\n",
       "      <td>391</td>\n",
       "      <td>15640</td>\n",
       "      <td>PARK HWY PROHIBED TIME/DAY</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2832538</th>\n",
       "      <td>2015</td>\n",
       "      <td>415</td>\n",
       "      <td>50 CUMBERLAND ST</td>\n",
       "      <td>390</td>\n",
       "      <td>15600</td>\n",
       "      <td>PARK COMMERC LOAD ZONE NOT LDG</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2796780</th>\n",
       "      <td>2015</td>\n",
       "      <td>403</td>\n",
       "      <td>590 KING ST W</td>\n",
       "      <td>104</td>\n",
       "      <td>15600</td>\n",
       "      <td>STOP-SIGNED HIGHWAY-RUSH HOUR</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2795504</th>\n",
       "      <td>2015</td>\n",
       "      <td>403</td>\n",
       "      <td>483 QUEEN ST W</td>\n",
       "      <td>104</td>\n",
       "      <td>15600</td>\n",
       "      <td>STOP-SIGNED HIGHWAY-RUSH HOUR</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2787684</th>\n",
       "      <td>2015</td>\n",
       "      <td>403</td>\n",
       "      <td>1005 KING ST W</td>\n",
       "      <td>104</td>\n",
       "      <td>15600</td>\n",
       "      <td>STOP-SIGNED HIGHWAY-RUSH HOUR</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2787951</th>\n",
       "      <td>2015</td>\n",
       "      <td>403</td>\n",
       "      <td>105 ADELAIDE ST W</td>\n",
       "      <td>104</td>\n",
       "      <td>15600</td>\n",
       "      <td>STOP-SIGNED HIGHWAY-RUSH HOUR</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2762209</th>\n",
       "      <td>2015</td>\n",
       "      <td>210</td>\n",
       "      <td>40 GERRARD ST E</td>\n",
       "      <td>518</td>\n",
       "      <td>15540</td>\n",
       "      <td>PARK FAIL TO DISPLAY RECEIPT</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2593561</th>\n",
       "      <td>2015</td>\n",
       "      <td>5</td>\n",
       "      <td>CHURCH ST</td>\n",
       "      <td>388</td>\n",
       "      <td>15520</td>\n",
       "      <td>PARK HWY PROHIBED TIME/DAY</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2780201</th>\n",
       "      <td>2015</td>\n",
       "      <td>347</td>\n",
       "      <td>151 TORYORK DR</td>\n",
       "      <td>62</td>\n",
       "      <td>15500</td>\n",
       "      <td>PARK IN A FIRE ROUTE</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2611886</th>\n",
       "      <td>2015</td>\n",
       "      <td>8</td>\n",
       "      <td>2 ORDE ST</td>\n",
       "      <td>258</td>\n",
       "      <td>15480</td>\n",
       "      <td>STAND SIGN HWY PRO TIMES/DAYS</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2521420</th>\n",
       "      <td>2015</td>\n",
       "      <td>3</td>\n",
       "      <td>15 DEVONSHIRE PL</td>\n",
       "      <td>516</td>\n",
       "      <td>15480</td>\n",
       "      <td>PARK/LEAVE ON PRIVATE PROPERTY</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2832631</th>\n",
       "      <td>2015</td>\n",
       "      <td>415</td>\n",
       "      <td>92 YORKVILLE AVE</td>\n",
       "      <td>387</td>\n",
       "      <td>15480</td>\n",
       "      <td>PARK COMMERC LOAD ZONE NOT LDG</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2792265</th>\n",
       "      <td>2015</td>\n",
       "      <td>403</td>\n",
       "      <td>22 COLLEGE ST</td>\n",
       "      <td>103</td>\n",
       "      <td>15450</td>\n",
       "      <td>STOP-SIGNED HIGHWAY-RUSH HOUR</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2795902</th>\n",
       "      <td>2015</td>\n",
       "      <td>403</td>\n",
       "      <td>511 QUEEN ST W</td>\n",
       "      <td>103</td>\n",
       "      <td>15450</td>\n",
       "      <td>STOP-SIGNED HIGHWAY-RUSH HOUR</td>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2576407</th>\n",
       "      <td>2015</td>\n",
       "      <td>5</td>\n",
       "      <td>5 WALTON ST</td>\n",
       "      <td>386</td>\n",
       "      <td>15440</td>\n",
       "      <td>PARK HWY PROHIBED TIME/DAY</td>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2743982</th>\n",
       "      <td>2015</td>\n",
       "      <td>207</td>\n",
       "      <td>20 EDWARD ST</td>\n",
       "      <td>513</td>\n",
       "      <td>15390</td>\n",
       "      <td>PARK FAIL TO DEP. FEE MACHINE</td>\n",
       "      <td>17</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2524322</th>\n",
       "      <td>2015</td>\n",
       "      <td>3</td>\n",
       "      <td>2157 LAKE SHORE BLVD W</td>\n",
       "      <td>512</td>\n",
       "      <td>15360</td>\n",
       "      <td>PARK/LEAVE ON PRIVATE PROPERTY</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2561856</th>\n",
       "      <td>2015</td>\n",
       "      <td>5</td>\n",
       "      <td>280 SIMCOE ST</td>\n",
       "      <td>383</td>\n",
       "      <td>15320</td>\n",
       "      <td>PARK HWY PROHIBED TIME/DAY</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2784897</th>\n",
       "      <td>2015</td>\n",
       "      <td>367</td>\n",
       "      <td>25 MUTUAL ST</td>\n",
       "      <td>34</td>\n",
       "      <td>15300</td>\n",
       "      <td>STAND ON-ST DISABL LDG NO PRMT</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>4000 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         year  infraction_code          street_address  count  fine_sum  \\\n",
       "53976    2008                3        25 THE WEST MALL   8291    248730   \n",
       "50294    2008                3        1750 FINCH AVE E   7525    225750   \n",
       "90392    2008                5            20 EDWARD ST   4328    173120   \n",
       "52076    2008                3        2075 BAYVIEW AVE   5394    161820   \n",
       "189893   2008                9            60 MURRAY ST   2683    160980   \n",
       "401943   2008              347         45 OVERLEA BLVD    479    119750   \n",
       "52075    2008                3         2075 BAYVIEW AV   3916    117480   \n",
       "169512   2008                8         244 VICTORIA ST   1820    109200   \n",
       "96905    2008                5           2401 YONGE ST   2552    102080   \n",
       "194386   2008                9                JAMES ST   1664     99840   \n",
       "181384   2008                9        200 ELIZABETH ST   1542     92520   \n",
       "190618   2008                9      66 WELLINGTON ST W   1510     90600   \n",
       "401342   2008              347          31 TAPSCOTT RD    361     90250   \n",
       "401487   2008              347        3401 DUFFERIN ST    355     88750   \n",
       "401252   2008              347          300 BOROUGH DR    351     87750   \n",
       "402185   2008              347           5100 YONGE ST    349     87250   \n",
       "206968   2008               15               43 ELM ST    869     86900   \n",
       "402836   2008              347         85 ELLESMERE RD    346     86500   \n",
       "400314   2008              347     1921 EGLINTON AVE E    335     83750   \n",
       "168739   2008                8           200 KING ST E   1344     80640   \n",
       "167484   2008                8          15 ASQUITH AVE   1280     76800   \n",
       "133887   2008                5          74 VICTORIA ST   1896     75840   \n",
       "81905    2008                5         158 VICTORIA ST   1867     74680   \n",
       "400851   2008              347        25 THE WEST MALL    298     74500   \n",
       "171430   2008                8    40 ORCHARD VIEW BLVD   1208     72480   \n",
       "47976    2008                3        1265 MILITARY TR   2409     72270   \n",
       "168680   2008                8       20 EGLINTON AVE W   1200     72000   \n",
       "381887   2008              250  1675 LAKE SHORE BLVD E    679     71295   \n",
       "173489   2008                8             78 HOLLY ST   1167     70020   \n",
       "402043   2008              347           4968 YONGE ST    276     69000   \n",
       "...       ...              ...                     ...    ...       ...   \n",
       "2791960  2015              403           21 BALMUTO ST    106     15900   \n",
       "2795889  2015              403           5100 YONGE ST    106     15900   \n",
       "2577273  2015                5        51 WINCHESTER ST    396     15840   \n",
       "2616499  2015                9            11 NELSON ST    264     15840   \n",
       "2500210  2015                2   34 LITTLE NORWAY CRES   1055     15825   \n",
       "2782733  2015              355           15 PROVOST DR     35     15750   \n",
       "2782069  2015              347           6464 YONGE ST     63     15750   \n",
       "2620104  2015                9         3 PARK HOME AVE    262     15720   \n",
       "2617692  2015                9        150 ELIZABETH ST    262     15720   \n",
       "2585237  2015                5          70 CHESTNUT PK    392     15680   \n",
       "2593640  2015                5             COXWELL AVE    391     15640   \n",
       "2557065  2015                5          23 VICTORIA ST    391     15640   \n",
       "2832538  2015              415        50 CUMBERLAND ST    390     15600   \n",
       "2796780  2015              403           590 KING ST W    104     15600   \n",
       "2795504  2015              403          483 QUEEN ST W    104     15600   \n",
       "2787684  2015              403          1005 KING ST W    104     15600   \n",
       "2787951  2015              403       105 ADELAIDE ST W    104     15600   \n",
       "2762209  2015              210         40 GERRARD ST E    518     15540   \n",
       "2593561  2015                5               CHURCH ST    388     15520   \n",
       "2780201  2015              347          151 TORYORK DR     62     15500   \n",
       "2611886  2015                8               2 ORDE ST    258     15480   \n",
       "2521420  2015                3        15 DEVONSHIRE PL    516     15480   \n",
       "2832631  2015              415        92 YORKVILLE AVE    387     15480   \n",
       "2792265  2015              403           22 COLLEGE ST    103     15450   \n",
       "2795902  2015              403          511 QUEEN ST W    103     15450   \n",
       "2576407  2015                5             5 WALTON ST    386     15440   \n",
       "2743982  2015              207            20 EDWARD ST    513     15390   \n",
       "2524322  2015                3  2157 LAKE SHORE BLVD W    512     15360   \n",
       "2561856  2015                5           280 SIMCOE ST    383     15320   \n",
       "2784897  2015              367            25 MUTUAL ST     34     15300   \n",
       "\n",
       "                            fine_descrp  mean_hour  \n",
       "53976    PARK/LEAVE ON PRIVATE PROPERTY         13  \n",
       "50294    PARK/LEAVE ON PRIVATE PROPERTY         13  \n",
       "90392        PARK HWY PROHIBED TIME/DAY         15  \n",
       "52076    PARK/LEAVE ON PRIVATE PROPERTY         12  \n",
       "189893     STOP HWY PROHIBITED TIME/DAY         13  \n",
       "401943             PARK IN A FIRE ROUTE         17  \n",
       "52075    PARK/LEAVE ON PRIVATE PROPERTY         12  \n",
       "169512    STAND SIGN HWY PRO TIMES/DAYS         14  \n",
       "96905        PARK HWY PROHIBED TIME/DAY         15  \n",
       "194386     STOP HWY PROHIBITED TIME/DAY         12  \n",
       "181384     STOP HWY PROHIBITED TIME/DAY         13  \n",
       "190618     STOP HWY PROHIBITED TIME/DAY         12  \n",
       "401342             PARK IN A FIRE ROUTE         15  \n",
       "401487             PARK IN A FIRE ROUTE         15  \n",
       "401252             PARK IN A FIRE ROUTE         15  \n",
       "402185             PARK IN A FIRE ROUTE         14  \n",
       "206968         PARK 3 M OF FIRE HYDRANT         15  \n",
       "402836             PARK IN A FIRE ROUTE         14  \n",
       "400314             PARK IN A FIRE ROUTE         14  \n",
       "168739    STAND SIGN HWY PRO TIMES/DAYS         14  \n",
       "167484    STAND SIGN HWY PRO TIMES/DAYS         12  \n",
       "133887       PARK HWY PROHIBED TIME/DAY         13  \n",
       "81905        PARK HWY PROHIBED TIME/DAY         14  \n",
       "400851             PARK IN A FIRE ROUTE         14  \n",
       "171430    STAND SIGN HWY PRO TIMES/DAYS         15  \n",
       "47976    PARK/LEAVE ON PRIVATE PROPERTY         15  \n",
       "168680    STAND SIGN HWY PRO TIMES/DAYS         12  \n",
       "381887   PARK IN PARK NOT IN DESIG AREA         16  \n",
       "173489    STAND SIGN HWY PRO TIMES/DAYS         14  \n",
       "402043             PARK IN A FIRE ROUTE         14  \n",
       "...                                 ...        ...  \n",
       "2791960   STOP-SIGNED HIGHWAY-RUSH HOUR         17  \n",
       "2795889   STOP-SIGNED HIGHWAY-RUSH HOUR         16  \n",
       "2577273      PARK HWY PROHIBED TIME/DAY         13  \n",
       "2616499    STOP HWY PROHIBITED TIME/DAY         13  \n",
       "2500210        PARK LONGER THAN 3 HOURS         12  \n",
       "2782733      PARK IN DISABLED NO PERMIT         13  \n",
       "2782069            PARK IN A FIRE ROUTE         13  \n",
       "2620104    STOP HWY PROHIBITED TIME/DAY         13  \n",
       "2617692    STOP HWY PROHIBITED TIME/DAY         13  \n",
       "2585237      PARK HWY PROHIBED TIME/DAY          8  \n",
       "2593640      PARK HWY PROHIBED TIME/DAY         16  \n",
       "2557065      PARK HWY PROHIBED TIME/DAY         14  \n",
       "2832538  PARK COMMERC LOAD ZONE NOT LDG         13  \n",
       "2796780   STOP-SIGNED HIGHWAY-RUSH HOUR         15  \n",
       "2795504   STOP-SIGNED HIGHWAY-RUSH HOUR         15  \n",
       "2787684   STOP-SIGNED HIGHWAY-RUSH HOUR         15  \n",
       "2787951   STOP-SIGNED HIGHWAY-RUSH HOUR         13  \n",
       "2762209    PARK FAIL TO DISPLAY RECEIPT         15  \n",
       "2593561      PARK HWY PROHIBED TIME/DAY         15  \n",
       "2780201            PARK IN A FIRE ROUTE         13  \n",
       "2611886   STAND SIGN HWY PRO TIMES/DAYS         15  \n",
       "2521420  PARK/LEAVE ON PRIVATE PROPERTY         15  \n",
       "2832631  PARK COMMERC LOAD ZONE NOT LDG         13  \n",
       "2792265   STOP-SIGNED HIGHWAY-RUSH HOUR         15  \n",
       "2795902   STOP-SIGNED HIGHWAY-RUSH HOUR         16  \n",
       "2576407      PARK HWY PROHIBED TIME/DAY         16  \n",
       "2743982   PARK FAIL TO DEP. FEE MACHINE         17  \n",
       "2524322  PARK/LEAVE ON PRIVATE PROPERTY          3  \n",
       "2561856      PARK HWY PROHIBED TIME/DAY         13  \n",
       "2784897  STAND ON-ST DISABL LDG NO PRMT         14  \n",
       "\n",
       "[4000 rows x 7 columns]"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "##create a DF with the top 500 grossing spots each year...\n",
    "final_df_2=None\n",
    "df_list=[]\n",
    "for year in range(2008,2016):\n",
    "    df_list.append(tpt_merged_df[tpt_merged_df['year']==year].sort_values('fine_sum',ascending=False).head(n=500))\n",
    "\n",
    "final_df_2= pd.concat(df_list, axis=0)\n",
    "\n",
    "##time formatting is weird; 5 --> 12:05am, 30 --> 12:30am, 15:20 --> 3:20pm etc.\n",
    "def round_time(df):\n",
    "    time_str=str(df['mean_time_of_infraction'])\n",
    "    time_len=len(time_str.split('.')[0])\n",
    "    if time_len==1:\n",
    "        rnded_time=0\n",
    "    elif time_len==2:\n",
    "        if float(time_str)<30:\n",
    "            rnded_time=0\n",
    "        else:\n",
    "            rnded_time=1\n",
    "    elif time_len==3:\n",
    "        rnded_time=round(float(time_str[0:1]+'.'+time_str[1:3]),0)\n",
    "    elif time_len==4:\n",
    "        rnded_time=round(float(time_str[0:2]+'.'+time_str[2:4]),0)\n",
    "    else:\n",
    "        rnded_time=0\n",
    "    return rnded_time\n",
    "\n",
    "\n",
    "final_df_2['mean_hour']=final_df_2.apply(round_time,axis=1)\n",
    "final_df_2=final_df_2.drop(['mean_time_of_infraction'],axis=1)\n",
    "\n",
    "final_df_2\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1141"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "locations_2=final_df_2['street_address'].unique()\n",
    "len(locations_2)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This gives us 2400 unique locations (under google api limit for one day!) for two different maps.\n",
    "\n",
    "1st map will be highest grossing fire hydrants\n",
    "- Visual Encodings -size --> fine amount -location--> location -colour -->infraction time\n",
    "2nd map will be highest grossing spots in general\n",
    "- Visual Encodings -size --> fine amount -location--> location -colour --> infraction type"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "list index out of range\n",
      "list index out of range\n",
      "list index out of range\n"
     ]
    }
   ],
   "source": [
    "req_url='https://maps.googleapis.com/maps/api/geocode/json?address={0}&key={1}'\n",
    "api_key = Ugen.ConfigSectionMap('googlemaps')['key']\n",
    "\n",
    "def get_coords(addr):\n",
    "    address=addr +' Toronto, Ontario, Canada'\n",
    "    try:\n",
    "        response = requests.get(req_url.format(address,api_key))\n",
    "        response_dict = response.json()\n",
    "        coords=response_dict['results'][0]['geometry']['location']\n",
    "        if response_dict['status'] == 'OK':\n",
    "#             print (response_dict)\n",
    "            return coords['lat'],coords['lng'],response_dict['results'][0]['formatted_address'].replace(',','')\n",
    "    except Exception as err:\n",
    "        print (str(err))\n",
    "        pass\n",
    "    return None,None,None\n",
    "\n",
    "####TO DO\n",
    "#need to change this so it gets all the different results..\n",
    "#then will need to update dataframes using these dicts...\n",
    "\n",
    "def dummy(x):\n",
    "    return x*1,x*2,x*3\n",
    "\n",
    "\n",
    "locations_1_dict={addr:get_coords(addr) for addr in locations_1}\n",
    "locations_2_dict={addr:get_coords(addr) for addr in locations_2}\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "##manually update 3 missing addresses due to api overlimit\n",
    "\n",
    "# '60 BLOOR ST W' \n",
    "# '231 KING ST E' #missing from dict 1\n",
    "# '43b BURNABY BLVD' #missing from dict 1\n",
    "\n",
    "locations_2_dict['60 BLOOR ST W' ]=(43.6701043,-79.3914649,'60 BLOOR ST W Toronto ON M4W Canada')\n",
    "locations_1_dict['231 KING ST E' ]=(43.6508972,-79.3709068,'231 KING ST E Toronto ON M5A 1J9 Canada')\n",
    "locations_1_dict['43b BURNABY BLVD' ]=(43.6683326,-79.3834478,'60 BLOOR ST W Toronto ON M4R 1B5 Canada')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>year</th>\n",
       "      <th>infraction_code</th>\n",
       "      <th>street_address</th>\n",
       "      <th>count</th>\n",
       "      <th>fine_sum</th>\n",
       "      <th>fine_descrp</th>\n",
       "      <th>mean_hour</th>\n",
       "      <th>lat</th>\n",
       "      <th>lng</th>\n",
       "      <th>full_address</th>\n",
       "      <th>fine_amt</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>206968</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>43 ELM ST</td>\n",
       "      <td>869</td>\n",
       "      <td>86900</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>15</td>\n",
       "      <td>43.657193</td>\n",
       "      <td>-79.383673</td>\n",
       "      <td>43 Elm St Toronto ON M5G 1H1 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>207724</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>5100 YONGE ST</td>\n",
       "      <td>496</td>\n",
       "      <td>49600</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "      <td>43.767283</td>\n",
       "      <td>-79.414745</td>\n",
       "      <td>5100 Yonge St Toronto ON M2N 5W4 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>206509</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>393 UNIVERSITY AVE</td>\n",
       "      <td>465</td>\n",
       "      <td>46500</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>12</td>\n",
       "      <td>43.654010</td>\n",
       "      <td>-79.387221</td>\n",
       "      <td>393 University Ave Toronto ON M5G Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>205795</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>33 ELMHURST AVE</td>\n",
       "      <td>397</td>\n",
       "      <td>39700</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>13</td>\n",
       "      <td>43.762424</td>\n",
       "      <td>-79.412830</td>\n",
       "      <td>33 Elmhurst Ave North York ON M2N 6G8 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>208114</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>56 THE ESPLANADE</td>\n",
       "      <td>384</td>\n",
       "      <td>38400</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>16</td>\n",
       "      <td>43.647104</td>\n",
       "      <td>-79.374197</td>\n",
       "      <td>56 The Esplanade Toronto ON M5E 1A6 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>206668</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>40 ORCHARD VIEW BLVD</td>\n",
       "      <td>327</td>\n",
       "      <td>32700</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>15</td>\n",
       "      <td>43.708178</td>\n",
       "      <td>-79.399706</td>\n",
       "      <td>40 Orchard View Blvd Toronto ON M4R 1B9 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>201055</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>112 MERTON ST</td>\n",
       "      <td>300</td>\n",
       "      <td>30000</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>13</td>\n",
       "      <td>43.697131</td>\n",
       "      <td>-79.392784</td>\n",
       "      <td>112 Merton St Toronto ON M4S 2Z8 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>207742</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>5150 YONGE ST</td>\n",
       "      <td>299</td>\n",
       "      <td>29900</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "      <td>43.768664</td>\n",
       "      <td>-79.413377</td>\n",
       "      <td>5150 Yonge St Toronto ON M2N 6L6 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>208370</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>6 SPRING GARDEN AVE</td>\n",
       "      <td>262</td>\n",
       "      <td>26200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>16</td>\n",
       "      <td>43.764527</td>\n",
       "      <td>-79.410704</td>\n",
       "      <td>6 Spring Garden Ave North York ON M2N 7M2 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>204778</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>26 WELLINGTON ST E</td>\n",
       "      <td>248</td>\n",
       "      <td>24800</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "      <td>43.648333</td>\n",
       "      <td>-79.375811</td>\n",
       "      <td>26 Wellington St E Toronto ON M5E 1S2 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>206231</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>361 UNIVERSITY AVE</td>\n",
       "      <td>246</td>\n",
       "      <td>24600</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>12</td>\n",
       "      <td>43.652927</td>\n",
       "      <td>-79.386030</td>\n",
       "      <td>361 University Ave Toronto ON M5G 1T3 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>208042</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>5519 YONGE ST</td>\n",
       "      <td>193</td>\n",
       "      <td>19300</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "      <td>43.778369</td>\n",
       "      <td>-79.414815</td>\n",
       "      <td>5519 Yonge St North York ON M2N 5S3 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>203011</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>184 SPADINA AVE</td>\n",
       "      <td>174</td>\n",
       "      <td>17400</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>15</td>\n",
       "      <td>43.649605</td>\n",
       "      <td>-79.397000</td>\n",
       "      <td>184 Spadina Ave Toronto ON M5T 2C2 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>210614</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>VILLIERS ST</td>\n",
       "      <td>168</td>\n",
       "      <td>16800</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>12</td>\n",
       "      <td>43.649661</td>\n",
       "      <td>-79.347094</td>\n",
       "      <td>Villiers St Toronto ON Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>205513</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>31 ELM ST</td>\n",
       "      <td>158</td>\n",
       "      <td>15800</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>16</td>\n",
       "      <td>43.657446</td>\n",
       "      <td>-79.382962</td>\n",
       "      <td>31 Elm St Toronto ON M5G 1H1 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>210145</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>98 THE ESPLANADE</td>\n",
       "      <td>155</td>\n",
       "      <td>15500</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>15</td>\n",
       "      <td>43.647833</td>\n",
       "      <td>-79.372561</td>\n",
       "      <td>98 The Esplanade Toronto ON M5E 1A9 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>202495</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>160 MUTUAL ST</td>\n",
       "      <td>150</td>\n",
       "      <td>15000</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>15</td>\n",
       "      <td>43.659282</td>\n",
       "      <td>-79.376813</td>\n",
       "      <td>160 Mutual St Toronto ON M5B 2M2 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>204407</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>2409 YONGE ST</td>\n",
       "      <td>147</td>\n",
       "      <td>14700</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "      <td>43.710360</td>\n",
       "      <td>-79.398705</td>\n",
       "      <td>2409 Yonge St Toronto ON M4P 2E7 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>209853</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>9 CHURCH ST</td>\n",
       "      <td>144</td>\n",
       "      <td>14400</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>15</td>\n",
       "      <td>43.647832</td>\n",
       "      <td>-79.373227</td>\n",
       "      <td>9 Church St Toronto ON M5E 1W1 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>206855</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>417 SPADINA RD</td>\n",
       "      <td>144</td>\n",
       "      <td>14400</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>12</td>\n",
       "      <td>43.688827</td>\n",
       "      <td>-79.412507</td>\n",
       "      <td>417 Spadina Rd Toronto ON M5P 2W3 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>205612</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>318 QUEEN ST W</td>\n",
       "      <td>142</td>\n",
       "      <td>14200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>15</td>\n",
       "      <td>43.649374</td>\n",
       "      <td>-79.394404</td>\n",
       "      <td>318 Queen St W Toronto ON M5V 2A2 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>207761</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>518 PALMERSTON BLVD</td>\n",
       "      <td>140</td>\n",
       "      <td>14000</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>15</td>\n",
       "      <td>43.663054</td>\n",
       "      <td>-79.413321</td>\n",
       "      <td>518 Palmerston Blvd Toronto ON M6G 2P3 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>210237</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>BOROUGH DR</td>\n",
       "      <td>138</td>\n",
       "      <td>13800</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>10</td>\n",
       "      <td>43.774796</td>\n",
       "      <td>-79.260929</td>\n",
       "      <td>Borough Dr Toronto ON M1P Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>202737</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>171 KING ST E</td>\n",
       "      <td>136</td>\n",
       "      <td>13600</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "      <td>43.650470</td>\n",
       "      <td>-79.371398</td>\n",
       "      <td>171 King St E Toronto ON M5A 1J4 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>205360</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>30 GLENDALE AVE</td>\n",
       "      <td>133</td>\n",
       "      <td>13300</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "      <td>43.640394</td>\n",
       "      <td>-79.451434</td>\n",
       "      <td>30 Glendale Ave Toronto ON M6R 2S7 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>206212</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>36 WELLINGTON ST E</td>\n",
       "      <td>132</td>\n",
       "      <td>13200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>15</td>\n",
       "      <td>43.648345</td>\n",
       "      <td>-79.375130</td>\n",
       "      <td>36 Wellington St E Toronto ON M5E Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>204505</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>25 BELLEVUE AVE</td>\n",
       "      <td>130</td>\n",
       "      <td>13000</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>13</td>\n",
       "      <td>43.653864</td>\n",
       "      <td>-79.403060</td>\n",
       "      <td>25 Bellevue Ave Toronto ON M5T 1K8 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>204109</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>227 VICTORIA ST</td>\n",
       "      <td>127</td>\n",
       "      <td>12700</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>15</td>\n",
       "      <td>43.655325</td>\n",
       "      <td>-79.378839</td>\n",
       "      <td>227 Victoria St Toronto ON M5B 1T8 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>201440</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>123 SUNNYSIDE AVE</td>\n",
       "      <td>125</td>\n",
       "      <td>12500</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "      <td>43.641982</td>\n",
       "      <td>-79.449524</td>\n",
       "      <td>123 Sunnyside Ave Toronto ON M6R 2P3 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>207670</th>\n",
       "      <td>2008</td>\n",
       "      <td>15</td>\n",
       "      <td>5050 YONGE ST</td>\n",
       "      <td>125</td>\n",
       "      <td>12500</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "      <td>43.767046</td>\n",
       "      <td>-79.413428</td>\n",
       "      <td>5050 Yonge St North York ON M2N 7H1 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2628348</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>1 SCOTT ST</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>13</td>\n",
       "      <td>43.646360</td>\n",
       "      <td>-79.375258</td>\n",
       "      <td>1 Scott St Toronto ON M5E 1A1 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2634934</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>68 NORTHCOTE AVE</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>8</td>\n",
       "      <td>43.644563</td>\n",
       "      <td>-79.426833</td>\n",
       "      <td>68 Northcote Ave Toronto ON M6J 3K3 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2636079</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>EAST LIBERTY ST</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>16</td>\n",
       "      <td>43.638422</td>\n",
       "      <td>-79.415172</td>\n",
       "      <td>E Liberty St Toronto ON M6K Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2633025</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>386 RONCESVALLES AVE</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "      <td>43.650757</td>\n",
       "      <td>-79.450935</td>\n",
       "      <td>386 Roncesvalles Ave Toronto ON M6R 2M9 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2628617</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>106 WALTON ST</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>13</td>\n",
       "      <td>43.657963</td>\n",
       "      <td>-79.385740</td>\n",
       "      <td>106 Walton St Toronto ON M5G 1Z2 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2634971</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>69 LAING ST</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "      <td>43.663447</td>\n",
       "      <td>-79.327011</td>\n",
       "      <td>69 Laing St Toronto ON M4L 1C2 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2629463</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>14 SAYWELL AVE</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "      <td>43.767042</td>\n",
       "      <td>-79.496035</td>\n",
       "      <td>14 Saywell Ave North York ON M3J 0E9 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2631291</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>238 BERKELEY ST</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>12</td>\n",
       "      <td>43.658186</td>\n",
       "      <td>-79.367244</td>\n",
       "      <td>238 Berkeley St Toronto ON M5A 2X4 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2634819</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>650 PARLIAMENT ST</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>11</td>\n",
       "      <td>43.669761</td>\n",
       "      <td>-79.370403</td>\n",
       "      <td>650 Parliament St Toronto ON M4X 1R3 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2634374</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>56 TEMPERANCE ST</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>13</td>\n",
       "      <td>43.650416</td>\n",
       "      <td>-79.381748</td>\n",
       "      <td>56 Temperance St Toronto ON M5H 3V5 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2630893</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>2120 QUEEN ST E</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>16</td>\n",
       "      <td>43.671378</td>\n",
       "      <td>-79.294700</td>\n",
       "      <td>2120 Queen St E Toronto ON M4E 1E2 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2629922</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>160 DAN LECKIE WAY</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>11</td>\n",
       "      <td>43.639991</td>\n",
       "      <td>-79.398488</td>\n",
       "      <td>160 Dan Leckie Way Toronto ON M5V 0E5 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2633700</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>47 DAVIES AVE</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>15</td>\n",
       "      <td>43.659748</td>\n",
       "      <td>-79.353949</td>\n",
       "      <td>47 Davies Ave Toronto ON M4M 2A9 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2634222</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>540 SPADINA CRES</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>8</td>\n",
       "      <td>43.659574</td>\n",
       "      <td>-79.401864</td>\n",
       "      <td>540 Spadina Crescent Toronto ON M5S 2J9 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2632002</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>29 NIAGARA ST</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "      <td>43.641992</td>\n",
       "      <td>-79.400515</td>\n",
       "      <td>29 Niagara St Toronto ON M5V 1C2 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2630843</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>21 MELINDA ST</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>13</td>\n",
       "      <td>43.648357</td>\n",
       "      <td>-79.378426</td>\n",
       "      <td>21 Melinda St Toronto ON M5E 1H5 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2635330</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>79 WINCHESTER ST</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "      <td>43.666064</td>\n",
       "      <td>-79.366775</td>\n",
       "      <td>79 Winchester St Toronto ON M4X 1B1 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2634391</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>561 QUEEN ST W</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>13</td>\n",
       "      <td>43.647695</td>\n",
       "      <td>-79.400455</td>\n",
       "      <td>561 Queen St W Toronto ON M5V 2B6 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2634866</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>660 CRAWFORD ST</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>13</td>\n",
       "      <td>43.661051</td>\n",
       "      <td>-79.421526</td>\n",
       "      <td>660 Crawford St Toronto ON M6G 3K2 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2632629</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>3397 YONGE ST</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "      <td>43.732551</td>\n",
       "      <td>-79.403931</td>\n",
       "      <td>3397 Yonge St North York ON M4N 2M8 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2635798</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>94 EVELYN WIGGINS DR</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>15</td>\n",
       "      <td>43.768923</td>\n",
       "      <td>-79.496225</td>\n",
       "      <td>94 Evelyn Wiggins Drive North York ON M3J 0E4 ...</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2636364</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>ST JOSEPH ST</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>15</td>\n",
       "      <td>43.665504</td>\n",
       "      <td>-79.388278</td>\n",
       "      <td>St Joseph St Toronto ON Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2634638</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>601 KINGSTON RD</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "      <td>43.678621</td>\n",
       "      <td>-79.298718</td>\n",
       "      <td>601 Kingston Rd Toronto ON M4E 1R3 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2634554</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>6 ANNDALE DR</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>17</td>\n",
       "      <td>43.760503</td>\n",
       "      <td>-79.408031</td>\n",
       "      <td>6 Anndale Dr North York ON M2N 2W8 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2629566</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>145 MUNRO ST</td>\n",
       "      <td>12</td>\n",
       "      <td>1200</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>13</td>\n",
       "      <td>43.662523</td>\n",
       "      <td>-79.353133</td>\n",
       "      <td>145 Munro St Toronto ON M4M 2B8 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2631968</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>287 ASSINIBOINE RD</td>\n",
       "      <td>11</td>\n",
       "      <td>1100</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>16</td>\n",
       "      <td>43.768678</td>\n",
       "      <td>-79.499299</td>\n",
       "      <td>287 Assiniboine Rd North York ON M3J 0C4 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2632891</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>368 ROXTON RD</td>\n",
       "      <td>11</td>\n",
       "      <td>1100</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>13</td>\n",
       "      <td>43.657737</td>\n",
       "      <td>-79.422748</td>\n",
       "      <td>368 Roxton Rd Toronto ON M6G 3R2 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2629682</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>15 ST MARY ST</td>\n",
       "      <td>11</td>\n",
       "      <td>1100</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>13</td>\n",
       "      <td>43.667804</td>\n",
       "      <td>-79.386698</td>\n",
       "      <td>15 St Mary St Toronto ON M4Y Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2634250</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>5453a YONGE ST</td>\n",
       "      <td>11</td>\n",
       "      <td>1100</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "      <td>43.777411</td>\n",
       "      <td>-79.414703</td>\n",
       "      <td>5453A Yonge St North York ON M2N 5S1 Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2636384</th>\n",
       "      <td>2015</td>\n",
       "      <td>15</td>\n",
       "      <td>TECUMSETH ST</td>\n",
       "      <td>11</td>\n",
       "      <td>1100</td>\n",
       "      <td>PARK 3 M OF FIRE HYDRANT</td>\n",
       "      <td>14</td>\n",
       "      <td>43.643379</td>\n",
       "      <td>-79.405263</td>\n",
       "      <td>Tecumseth St Toronto ON Canada</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>4000 rows × 11 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         year  infraction_code        street_address  count  fine_sum  \\\n",
       "206968   2008               15             43 ELM ST    869     86900   \n",
       "207724   2008               15         5100 YONGE ST    496     49600   \n",
       "206509   2008               15    393 UNIVERSITY AVE    465     46500   \n",
       "205795   2008               15       33 ELMHURST AVE    397     39700   \n",
       "208114   2008               15      56 THE ESPLANADE    384     38400   \n",
       "206668   2008               15  40 ORCHARD VIEW BLVD    327     32700   \n",
       "201055   2008               15         112 MERTON ST    300     30000   \n",
       "207742   2008               15         5150 YONGE ST    299     29900   \n",
       "208370   2008               15   6 SPRING GARDEN AVE    262     26200   \n",
       "204778   2008               15    26 WELLINGTON ST E    248     24800   \n",
       "206231   2008               15    361 UNIVERSITY AVE    246     24600   \n",
       "208042   2008               15         5519 YONGE ST    193     19300   \n",
       "203011   2008               15       184 SPADINA AVE    174     17400   \n",
       "210614   2008               15           VILLIERS ST    168     16800   \n",
       "205513   2008               15             31 ELM ST    158     15800   \n",
       "210145   2008               15      98 THE ESPLANADE    155     15500   \n",
       "202495   2008               15         160 MUTUAL ST    150     15000   \n",
       "204407   2008               15         2409 YONGE ST    147     14700   \n",
       "209853   2008               15           9 CHURCH ST    144     14400   \n",
       "206855   2008               15        417 SPADINA RD    144     14400   \n",
       "205612   2008               15        318 QUEEN ST W    142     14200   \n",
       "207761   2008               15   518 PALMERSTON BLVD    140     14000   \n",
       "210237   2008               15            BOROUGH DR    138     13800   \n",
       "202737   2008               15         171 KING ST E    136     13600   \n",
       "205360   2008               15       30 GLENDALE AVE    133     13300   \n",
       "206212   2008               15    36 WELLINGTON ST E    132     13200   \n",
       "204505   2008               15       25 BELLEVUE AVE    130     13000   \n",
       "204109   2008               15       227 VICTORIA ST    127     12700   \n",
       "201440   2008               15     123 SUNNYSIDE AVE    125     12500   \n",
       "207670   2008               15         5050 YONGE ST    125     12500   \n",
       "...       ...              ...                   ...    ...       ...   \n",
       "2628348  2015               15            1 SCOTT ST     12      1200   \n",
       "2634934  2015               15      68 NORTHCOTE AVE     12      1200   \n",
       "2636079  2015               15       EAST LIBERTY ST     12      1200   \n",
       "2633025  2015               15  386 RONCESVALLES AVE     12      1200   \n",
       "2628617  2015               15         106 WALTON ST     12      1200   \n",
       "2634971  2015               15           69 LAING ST     12      1200   \n",
       "2629463  2015               15        14 SAYWELL AVE     12      1200   \n",
       "2631291  2015               15       238 BERKELEY ST     12      1200   \n",
       "2634819  2015               15     650 PARLIAMENT ST     12      1200   \n",
       "2634374  2015               15      56 TEMPERANCE ST     12      1200   \n",
       "2630893  2015               15       2120 QUEEN ST E     12      1200   \n",
       "2629922  2015               15    160 DAN LECKIE WAY     12      1200   \n",
       "2633700  2015               15         47 DAVIES AVE     12      1200   \n",
       "2634222  2015               15      540 SPADINA CRES     12      1200   \n",
       "2632002  2015               15         29 NIAGARA ST     12      1200   \n",
       "2630843  2015               15         21 MELINDA ST     12      1200   \n",
       "2635330  2015               15      79 WINCHESTER ST     12      1200   \n",
       "2634391  2015               15        561 QUEEN ST W     12      1200   \n",
       "2634866  2015               15       660 CRAWFORD ST     12      1200   \n",
       "2632629  2015               15         3397 YONGE ST     12      1200   \n",
       "2635798  2015               15  94 EVELYN WIGGINS DR     12      1200   \n",
       "2636364  2015               15          ST JOSEPH ST     12      1200   \n",
       "2634638  2015               15       601 KINGSTON RD     12      1200   \n",
       "2634554  2015               15          6 ANNDALE DR     12      1200   \n",
       "2629566  2015               15          145 MUNRO ST     12      1200   \n",
       "2631968  2015               15    287 ASSINIBOINE RD     11      1100   \n",
       "2632891  2015               15         368 ROXTON RD     11      1100   \n",
       "2629682  2015               15         15 ST MARY ST     11      1100   \n",
       "2634250  2015               15        5453a YONGE ST     11      1100   \n",
       "2636384  2015               15          TECUMSETH ST     11      1100   \n",
       "\n",
       "                      fine_descrp  mean_hour        lat        lng  \\\n",
       "206968   PARK 3 M OF FIRE HYDRANT         15  43.657193 -79.383673   \n",
       "207724   PARK 3 M OF FIRE HYDRANT         14  43.767283 -79.414745   \n",
       "206509   PARK 3 M OF FIRE HYDRANT         12  43.654010 -79.387221   \n",
       "205795   PARK 3 M OF FIRE HYDRANT         13  43.762424 -79.412830   \n",
       "208114   PARK 3 M OF FIRE HYDRANT         16  43.647104 -79.374197   \n",
       "206668   PARK 3 M OF FIRE HYDRANT         15  43.708178 -79.399706   \n",
       "201055   PARK 3 M OF FIRE HYDRANT         13  43.697131 -79.392784   \n",
       "207742   PARK 3 M OF FIRE HYDRANT         14  43.768664 -79.413377   \n",
       "208370   PARK 3 M OF FIRE HYDRANT         16  43.764527 -79.410704   \n",
       "204778   PARK 3 M OF FIRE HYDRANT         14  43.648333 -79.375811   \n",
       "206231   PARK 3 M OF FIRE HYDRANT         12  43.652927 -79.386030   \n",
       "208042   PARK 3 M OF FIRE HYDRANT         14  43.778369 -79.414815   \n",
       "203011   PARK 3 M OF FIRE HYDRANT         15  43.649605 -79.397000   \n",
       "210614   PARK 3 M OF FIRE HYDRANT         12  43.649661 -79.347094   \n",
       "205513   PARK 3 M OF FIRE HYDRANT         16  43.657446 -79.382962   \n",
       "210145   PARK 3 M OF FIRE HYDRANT         15  43.647833 -79.372561   \n",
       "202495   PARK 3 M OF FIRE HYDRANT         15  43.659282 -79.376813   \n",
       "204407   PARK 3 M OF FIRE HYDRANT         14  43.710360 -79.398705   \n",
       "209853   PARK 3 M OF FIRE HYDRANT         15  43.647832 -79.373227   \n",
       "206855   PARK 3 M OF FIRE HYDRANT         12  43.688827 -79.412507   \n",
       "205612   PARK 3 M OF FIRE HYDRANT         15  43.649374 -79.394404   \n",
       "207761   PARK 3 M OF FIRE HYDRANT         15  43.663054 -79.413321   \n",
       "210237   PARK 3 M OF FIRE HYDRANT         10  43.774796 -79.260929   \n",
       "202737   PARK 3 M OF FIRE HYDRANT         14  43.650470 -79.371398   \n",
       "205360   PARK 3 M OF FIRE HYDRANT         14  43.640394 -79.451434   \n",
       "206212   PARK 3 M OF FIRE HYDRANT         15  43.648345 -79.375130   \n",
       "204505   PARK 3 M OF FIRE HYDRANT         13  43.653864 -79.403060   \n",
       "204109   PARK 3 M OF FIRE HYDRANT         15  43.655325 -79.378839   \n",
       "201440   PARK 3 M OF FIRE HYDRANT         14  43.641982 -79.449524   \n",
       "207670   PARK 3 M OF FIRE HYDRANT         14  43.767046 -79.413428   \n",
       "...                           ...        ...        ...        ...   \n",
       "2628348  PARK 3 M OF FIRE HYDRANT         13  43.646360 -79.375258   \n",
       "2634934  PARK 3 M OF FIRE HYDRANT          8  43.644563 -79.426833   \n",
       "2636079  PARK 3 M OF FIRE HYDRANT         16  43.638422 -79.415172   \n",
       "2633025  PARK 3 M OF FIRE HYDRANT         14  43.650757 -79.450935   \n",
       "2628617  PARK 3 M OF FIRE HYDRANT         13  43.657963 -79.385740   \n",
       "2634971  PARK 3 M OF FIRE HYDRANT         14  43.663447 -79.327011   \n",
       "2629463  PARK 3 M OF FIRE HYDRANT         14  43.767042 -79.496035   \n",
       "2631291  PARK 3 M OF FIRE HYDRANT         12  43.658186 -79.367244   \n",
       "2634819  PARK 3 M OF FIRE HYDRANT         11  43.669761 -79.370403   \n",
       "2634374  PARK 3 M OF FIRE HYDRANT         13  43.650416 -79.381748   \n",
       "2630893  PARK 3 M OF FIRE HYDRANT         16  43.671378 -79.294700   \n",
       "2629922  PARK 3 M OF FIRE HYDRANT         11  43.639991 -79.398488   \n",
       "2633700  PARK 3 M OF FIRE HYDRANT         15  43.659748 -79.353949   \n",
       "2634222  PARK 3 M OF FIRE HYDRANT          8  43.659574 -79.401864   \n",
       "2632002  PARK 3 M OF FIRE HYDRANT         14  43.641992 -79.400515   \n",
       "2630843  PARK 3 M OF FIRE HYDRANT         13  43.648357 -79.378426   \n",
       "2635330  PARK 3 M OF FIRE HYDRANT         14  43.666064 -79.366775   \n",
       "2634391  PARK 3 M OF FIRE HYDRANT         13  43.647695 -79.400455   \n",
       "2634866  PARK 3 M OF FIRE HYDRANT         13  43.661051 -79.421526   \n",
       "2632629  PARK 3 M OF FIRE HYDRANT         14  43.732551 -79.403931   \n",
       "2635798  PARK 3 M OF FIRE HYDRANT         15  43.768923 -79.496225   \n",
       "2636364  PARK 3 M OF FIRE HYDRANT         15  43.665504 -79.388278   \n",
       "2634638  PARK 3 M OF FIRE HYDRANT         14  43.678621 -79.298718   \n",
       "2634554  PARK 3 M OF FIRE HYDRANT         17  43.760503 -79.408031   \n",
       "2629566  PARK 3 M OF FIRE HYDRANT         13  43.662523 -79.353133   \n",
       "2631968  PARK 3 M OF FIRE HYDRANT         16  43.768678 -79.499299   \n",
       "2632891  PARK 3 M OF FIRE HYDRANT         13  43.657737 -79.422748   \n",
       "2629682  PARK 3 M OF FIRE HYDRANT         13  43.667804 -79.386698   \n",
       "2634250  PARK 3 M OF FIRE HYDRANT         14  43.777411 -79.414703   \n",
       "2636384  PARK 3 M OF FIRE HYDRANT         14  43.643379 -79.405263   \n",
       "\n",
       "                                              full_address  fine_amt  \n",
       "206968                 43 Elm St Toronto ON M5G 1H1 Canada       100  \n",
       "207724             5100 Yonge St Toronto ON M2N 5W4 Canada       100  \n",
       "206509            393 University Ave Toronto ON M5G Canada       100  \n",
       "205795        33 Elmhurst Ave North York ON M2N 6G8 Canada       100  \n",
       "208114          56 The Esplanade Toronto ON M5E 1A6 Canada       100  \n",
       "206668      40 Orchard View Blvd Toronto ON M4R 1B9 Canada       100  \n",
       "201055             112 Merton St Toronto ON M4S 2Z8 Canada       100  \n",
       "207742             5150 Yonge St Toronto ON M2N 6L6 Canada       100  \n",
       "208370    6 Spring Garden Ave North York ON M2N 7M2 Canada       100  \n",
       "204778        26 Wellington St E Toronto ON M5E 1S2 Canada       100  \n",
       "206231        361 University Ave Toronto ON M5G 1T3 Canada       100  \n",
       "208042          5519 Yonge St North York ON M2N 5S3 Canada       100  \n",
       "203011           184 Spadina Ave Toronto ON M5T 2C2 Canada       100  \n",
       "210614                       Villiers St Toronto ON Canada       100  \n",
       "205513                 31 Elm St Toronto ON M5G 1H1 Canada       100  \n",
       "210145          98 The Esplanade Toronto ON M5E 1A9 Canada       100  \n",
       "202495             160 Mutual St Toronto ON M5B 2M2 Canada       100  \n",
       "204407             2409 Yonge St Toronto ON M4P 2E7 Canada       100  \n",
       "209853               9 Church St Toronto ON M5E 1W1 Canada       100  \n",
       "206855            417 Spadina Rd Toronto ON M5P 2W3 Canada       100  \n",
       "205612            318 Queen St W Toronto ON M5V 2A2 Canada       100  \n",
       "207761       518 Palmerston Blvd Toronto ON M6G 2P3 Canada       100  \n",
       "210237                    Borough Dr Toronto ON M1P Canada       100  \n",
       "202737             171 King St E Toronto ON M5A 1J4 Canada       100  \n",
       "205360           30 Glendale Ave Toronto ON M6R 2S7 Canada       100  \n",
       "206212            36 Wellington St E Toronto ON M5E Canada       100  \n",
       "204505           25 Bellevue Ave Toronto ON M5T 1K8 Canada       100  \n",
       "204109           227 Victoria St Toronto ON M5B 1T8 Canada       100  \n",
       "201440         123 Sunnyside Ave Toronto ON M6R 2P3 Canada       100  \n",
       "207670          5050 Yonge St North York ON M2N 7H1 Canada       100  \n",
       "...                                                    ...       ...  \n",
       "2628348               1 Scott St Toronto ON M5E 1A1 Canada       100  \n",
       "2634934         68 Northcote Ave Toronto ON M6J 3K3 Canada       100  \n",
       "2636079                 E Liberty St Toronto ON M6K Canada       100  \n",
       "2633025     386 Roncesvalles Ave Toronto ON M6R 2M9 Canada       100  \n",
       "2628617            106 Walton St Toronto ON M5G 1Z2 Canada       100  \n",
       "2634971              69 Laing St Toronto ON M4L 1C2 Canada       100  \n",
       "2629463        14 Saywell Ave North York ON M3J 0E9 Canada       100  \n",
       "2631291          238 Berkeley St Toronto ON M5A 2X4 Canada       100  \n",
       "2634819        650 Parliament St Toronto ON M4X 1R3 Canada       100  \n",
       "2634374         56 Temperance St Toronto ON M5H 3V5 Canada       100  \n",
       "2630893          2120 Queen St E Toronto ON M4E 1E2 Canada       100  \n",
       "2629922       160 Dan Leckie Way Toronto ON M5V 0E5 Canada       100  \n",
       "2633700            47 Davies Ave Toronto ON M4M 2A9 Canada       100  \n",
       "2634222     540 Spadina Crescent Toronto ON M5S 2J9 Canada       100  \n",
       "2632002            29 Niagara St Toronto ON M5V 1C2 Canada       100  \n",
       "2630843            21 Melinda St Toronto ON M5E 1H5 Canada       100  \n",
       "2635330         79 Winchester St Toronto ON M4X 1B1 Canada       100  \n",
       "2634391           561 Queen St W Toronto ON M5V 2B6 Canada       100  \n",
       "2634866          660 Crawford St Toronto ON M6G 3K2 Canada       100  \n",
       "2632629         3397 Yonge St North York ON M4N 2M8 Canada       100  \n",
       "2635798  94 Evelyn Wiggins Drive North York ON M3J 0E4 ...       100  \n",
       "2636364                     St Joseph St Toronto ON Canada       100  \n",
       "2634638          601 Kingston Rd Toronto ON M4E 1R3 Canada       100  \n",
       "2634554          6 Anndale Dr North York ON M2N 2W8 Canada       100  \n",
       "2629566             145 Munro St Toronto ON M4M 2B8 Canada       100  \n",
       "2631968    287 Assiniboine Rd North York ON M3J 0C4 Canada       100  \n",
       "2632891            368 Roxton Rd Toronto ON M6G 3R2 Canada       100  \n",
       "2629682                15 St Mary St Toronto ON M4Y Canada       100  \n",
       "2634250        5453A Yonge St North York ON M2N 5S1 Canada       100  \n",
       "2636384                     Tecumseth St Toronto ON Canada       100  \n",
       "\n",
       "[4000 rows x 11 columns]"
      ]
     },
     "execution_count": 56,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "##update final_df's with google data\n",
    "##add fine amounts\n",
    "\n",
    "final_df['lat']=final_df['street_address'].map(lambda x: locations_1_dict[x][0])\n",
    "final_df['lng']=final_df['street_address'].map(lambda x: locations_1_dict[x][1])\n",
    "final_df['full_address']=final_df['street_address'].map(lambda x: locations_1_dict[x][2])\n",
    "final_df['fine_amt']=final_df['infraction_code'].map(lambda x: fine_amount_dict[x]['fine_amt'])\n",
    "\n",
    "final_df_2['lat']=final_df_2['street_address'].map(lambda x: locations_2_dict[x][0])\n",
    "final_df_2['lng']=final_df_2['street_address'].map(lambda x: locations_2_dict[x][1])\n",
    "final_df_2['full_address']=final_df_2['street_address'].map(lambda x: locations_2_dict[x][2])\n",
    "final_df_2['fine_amt']=final_df_2['infraction_code'].map(lambda x: fine_amount_dict[x]['fine_amt'])\n",
    "\n",
    "final_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "# final_df.to_csv('./top_hydrants.csv')\n",
    "# final_df_2.to_csv('./top_spots.csv')\n",
    "\n",
    "# fine_amt_df.to_csv('./fine_amount_coding.csv')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "General notes:\n",
    "- apparently hydrant fines changed from 30to100 part way through 2008\n",
    "- with your current method your multipying all fines by $100 so numbers will be a bit off...\n",
    "\n",
    "\n",
    "To Do:\n",
    "- interactive dashboard\n",
    "- time series graphs based on user selection of location and infraction code (or show multiple infraction codes per graph)\n",
    "- overall summary (fine sums per year, fine sums per year per infrac_code)\n",
    "\n",
    "Interactive Map:\n",
    "- Visual Encodings\n",
    "     -size --> fine amount\n",
    "     -location--> location\n",
    "     -colour --> infraction code OR infraction time\n",
    "     -pop-up menu --> count, fine_amt & fine description"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python [Root]",
   "language": "python",
   "name": "Python [Root]"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 2
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython2",
   "version": "2.7.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 0
}
